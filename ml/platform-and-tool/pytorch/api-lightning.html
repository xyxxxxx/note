
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="xyx">
      
      
        <link rel="canonical" href="https://xyxxxxx.github.io/note/ml/platform-and-tool/pytorch/api-lightning.html">
      
      
        <link rel="prev" href="lightning.html">
      
      
        <link rel="next" href="../horovod.html">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.1">
    
    
      
        <title>API: lightning - 笔记</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.45e1311d.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="light-green">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pytorch_lightning" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../.." title="笔记" class="md-header__button md-logo" aria-label="笔记" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            笔记
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API: lightning
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="分享" aria-label="分享" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../index.html" class="md-tabs__link">
        
  
    
  
  首页

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../math/index.html" class="md-tabs__link">
          
  
    
  
  数学

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../cs/dsa/data-structure/index.html" class="md-tabs__link">
          
  
    
  
  CS

        </a>
      </li>
    
  

    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../python/index.html" class="md-tabs__link">
          
  
    
  
  Python

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../index.html" class="md-tabs__link">
          
  
    
  
  机器学习

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../reference-and-tool/linux/linux-command.html" class="md-tabs__link">
          
  
    
  
  参考和工具

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../web/simple-html.html" class="md-tabs__link">
          
  
    
  
  前端

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="笔记" class="md-nav__button md-logo" aria-label="笔记" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    笔记
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    首页
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../math/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    数学
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            数学
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../math/algebra/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    代数
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            代数
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../math/algebra/elementary-algebra.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    基础代数
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../math/algebra/linear-algebra.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    线性代数
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../math/algebra/linear-algebra-understanding.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    线性代数理解
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../math/algebra/abstract-algebra.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    抽象代数
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../math/analysis/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    分析
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            分析
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../math/analysis/calculus.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    微积分
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../math/analysis/multivariate-calculus.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    多元微积分
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../math/analysis/matrix-calculus.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    矩阵微积分
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../math/analysis/differential-equation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    微分方程
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../math/analysis/complex-analysis.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    复分析
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../math/analysis/mathematical-physics.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    数学物理
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../math/applied-mathematics/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    应用数学
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            应用数学
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../math/applied-mathematics/optimization/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    数学优化
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_4_2" id="__nav_2_4_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_2">
            <span class="md-nav__icon md-icon"></span>
            数学优化
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../math/applied-mathematics/optimization/convex-set.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    凸集
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../math/applied-mathematics/optimization/convex-function.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    凸函数
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../math/applied-mathematics/optimization/convex-optimization.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    凸优化
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../math/applied-mathematics/optimization/duality.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    对偶性
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../math/applied-mathematics/optimization/nlp.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    非线性优化
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../math/applied-mathematics/probability-theory-and-mathematical-statistics/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    概率论与数理统计
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_4_3" id="__nav_2_4_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_3">
            <span class="md-nav__icon md-icon"></span>
            概率论与数理统计
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../math/applied-mathematics/probability-theory-and-mathematical-statistics/probability-of-event.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    事件的概率
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../math/applied-mathematics/probability-theory-and-mathematical-statistics/random-variable.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    随机变量
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../math/applied-mathematics/probability-theory-and-mathematical-statistics/limit-theorems.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    极限定理
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../math/applied-mathematics/stochastic-process/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    随机过程
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_4_4" id="__nav_2_4_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_4">
            <span class="md-nav__icon md-icon"></span>
            随机过程
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../math/applied-mathematics/stochastic-process/stochastic-process-introduction.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    随机过程基础
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../math/applied-mathematics/stochastic-process/markov-chain.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    马尔可夫链
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../math/applied-mathematics/stochastic-process/poisson-process.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    泊松过程
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../math/discrete-mathematics/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    离散数学
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            离散数学
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../math/discrete-mathematics/mathematical-logic.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    数学逻辑
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../math/discrete-mathematics/set-theory.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    集合论
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../math/discrete-mathematics/enumerative-combinatorics.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    组合数学
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../math/discrete-mathematics/polynomial.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    多项式
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../math/discrete-mathematics/graph-theory.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    图论
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../math/discrete-mathematics/number-theory.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    数论
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    CS
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            CS
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    数据结构与算法
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            数据结构与算法
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../cs/dsa/data-structure/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    数据结构
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1" id="__nav_3_1_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1">
            <span class="md-nav__icon md-icon"></span>
            数据结构
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/dsa/data-structure/array-and-linked-list.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    数组和链表
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/dsa/data-structure/stack-and-queue.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    栈和队列
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/dsa/data-structure/binary-search-tree.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    二叉搜索树
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/dsa/data-structure/hash-table.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    哈希表
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/dsa/data-structure/graph.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    图
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/dsa/data-structure/heap.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    堆
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../cs/dsa/algorithm/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    算法
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_2" id="__nav_3_1_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_2">
            <span class="md-nav__icon md-icon"></span>
            算法
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/dsa/algorithm/common-algorithm.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    常见算法
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/dsa/algorithm/divide-and-conquer.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    分而治之
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/dsa/algorithm/dynamic-programming.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    动态规划
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/dsa/algorithm/greedy-algorithm.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    贪心算法
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/dsa/algorithm/backtracking.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    回溯法
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/dsa/algorithm/network-flow-algorithm.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    网络流算法
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/dsa/algorithm/linear-programming.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    线性规划
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/dsa/leetcode-examples.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Leetcode 例题
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../cs/net/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    网络
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            网络
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../cs/net/net-model/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    网络模型
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_2_2" id="__nav_3_2_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_2">
            <span class="md-nav__icon md-icon"></span>
            网络模型
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/net/net-model/transport-layer.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    传输层
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/net/net-model/network-layer.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    网络层
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/net/net-model/application-layer.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    应用层
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../cs/information-theory/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    信息论
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            信息论
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/information-theory/entropy.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    熵、相对熵与互信息
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../python/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Python
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/runtime-environment-devtool.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    运行环境与开发工具
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/data-type-and-operation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    数据类型与操作
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/function.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    函数
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/control-flow.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    控制流
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/container-type.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    容器类型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/iterator-and-generator.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    迭代器与生成器
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/oop.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    面向对象编程
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/io.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IO
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/process-and-thread.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    进程与线程
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/error-handling-and-unit-test.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    错误处理与单元测试
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/module-and-package.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    模块与包
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_13" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../python/standard-library/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    标准库
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_13" id="__nav_4_13_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_13">
            <span class="md-nav__icon md-icon"></span>
            标准库
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/argparse.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    argparse——命令行选项、参数和子命令解析器
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/base64.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    base64——Base16, Base32, Base64, Base85 数据编码
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/builtins.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    builtins——内建对象
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/collections.abc.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    collections.abc——容器的抽象基类
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/collections.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    collections——容器数据类型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/configparser.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    configparser——配置文件解析器
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/concurrent.futures.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    concurrent.futures——启动并行任务
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/copy.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    copy——浅层和深层复制操作
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/csv.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    csv——CSV 文件读写
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/datetime.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    datetime——基本日期和时间类型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/enum.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    enum——对枚举的支持
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/functions.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    内置函数
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/functools.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    functools——高阶函数和可调用对象上的操作
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/glob.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    glob——Unix 风格路径名模式扩展
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/graphlib.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphlib——操作类似图的结构的功能
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/hashlib.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hashlib——安全哈希与消息摘要
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/hmac.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hmac——基于密钥的消息验证
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/importlib.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    importlib——import 的实现
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/inspect.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    inspect——检查对象
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/io.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    io——处理流的核心工具
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/itertools.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    itertools——为高效循环而创建迭代器的函数
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/json.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    json——JSON 编码和解码器
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/keyword.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    keyword——检验 Python 关键字
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/marshal.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    marshal——内部 Python 对象序列化
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/math.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    math——数学函数
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/multiprocessing.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    multiprocessing——基于进程的并行
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/operator.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    operator——标准运算符替代函数
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/os.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    os——多种操作系统接口
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/os.path.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    os.path——常用路径操作
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/pathlib.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pathlib——面向对象的文件系统路径
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/pickle.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pickle——Python 对象序列化
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/platform.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    platform——获取底层平台的标识数据
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/pprint.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pprint——数据美化输出
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/queue.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    queue——一个同步的队列类
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/random.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    random——生成伪随机数
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/re.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    re——正则表达式操作
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/secrets.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    secrets——生成安全随机数字用于管理密码
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/select.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    select——等待 I/O 完成
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/shlex.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    shlex——简单的词法分析
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/shutil.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    shutil——高阶文件操作
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/signal.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    signal——设置异步事件处理程序
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/socket.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    socket——底层网络接口
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/subprocess.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    subprocess——子进程管理
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/sys.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sys——系统相关的参数和函数
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/tarfile.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tarfile——读写 tar 归档文件
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/tempfile.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tempfile——生成临时文件和目录
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/threading.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    threading——基于线程的并行
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/time.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    time——时间的访问和转换
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/timeit.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    timeit——测量小段代码的执行时间
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/types.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    types——动态类型创建和内置类型名称
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/typing.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    typing——类型提示支持
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/urllib.parse.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    urllib.parse——用于解析 URL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/urllib.request.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    urllib.request——用于打开 URL 的可扩展库
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/uuid.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    uuid——RFC 4122 定义的 UUID 对象
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/weakref.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    weakref——弱引用
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/standard-library/zipfile.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    zipfile——使用 ZIP 存档
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_14" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../python/common-library/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    常用库
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_14" id="__nav_4_14_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_14">
            <span class="md-nav__icon md-icon"></span>
            常用库
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/common-library/beautifulsoup.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BeautifulSoup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/common-library/click.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    click
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/common-library/filelock.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    filelock
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/common-library/pillow.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pillow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/common-library/pyyaml.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyYAML (yaml)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/common-library/requests.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    requests
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/common-library/rich.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rich
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/common-library/websocket-client.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    websocket-client (websocket)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/style-guide.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    风格指南
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    机器学习
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            机器学习
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    统计学习
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            统计学习
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../statistical-learning/regression.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    回归
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../statistical-learning/nb.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    朴素贝叶斯
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../statistical-learning/perceptron.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    感知器
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../statistical-learning/svm.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    支持向量机
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    深度学习
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            深度学习
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../deep-learning/fnn.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    前馈神经网络（FNN）
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../deep-learning/cnn.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    卷积神经网络（CNN）
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../deep-learning/rnn.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    循环神经网络（RNN）
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../deep-learning/embedding.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    嵌入
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../deep-learning/seq2seq.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    序列到序列模型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../deep-learning/transformer.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transformer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../deep-learning/self-supervised.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    自监督学习模型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../deep-learning/gan.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    生成对抗网络（GAN）
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../deep-learning/rl.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    强化学习
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../deep-learning/auto-learning.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    自动学习
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    常用技术
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            常用技术
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../technique/optimization.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    优化
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../technique/normalization.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    归一化
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../technique/generalization.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    泛化
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../technique/anomaly-detection.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    异常检测
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../technique/adversarial-attack.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    对抗攻击
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../technique/explainable-ml.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    模型可解释性
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../technique/transfer-learning.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    迁移学习
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../technique/model-compression.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    模型压缩
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../technique/life-long-learning.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    终身学习
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../nlp/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    自然语言处理专题
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_5" id="__nav_5_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_5">
            <span class="md-nav__icon md-icon"></span>
            自然语言处理专题
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nlp/text-processing.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    文本处理
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nlp/language-model.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    语言模型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nlp/sentiment-classification.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    朴素贝叶斯和情感分类
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nlp/logistic-regression.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    逻辑回归
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nlp/embedding.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    嵌入
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nlp/neural-network.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    神经网络
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nlp/part-of-speech-tagging.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    词性标注和命名实体检测
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../distributed/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    分布式训练
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6">
            <span class="md-nav__icon md-icon"></span>
            分布式训练
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_7" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    平台和工具
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_7" id="__nav_5_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_7">
            <span class="md-nav__icon md-icon"></span>
            平台和工具
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_7_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../numpy/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    NumPy
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_7_2" id="__nav_5_7_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_7_2">
            <span class="md-nav__icon md-icon"></span>
            NumPy
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../numpy/get-started.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    快速入门
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../numpy/api.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_7_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../pandas/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    pandas
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_7_3" id="__nav_5_7_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_7_3">
            <span class="md-nav__icon md-icon"></span>
            pandas
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pandas/get-started.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    快速入门
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pandas/api.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_7_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../matplotlib/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    matplotlib
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_7_4" id="__nav_5_7_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_7_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_7_4">
            <span class="md-nav__icon md-icon"></span>
            matplotlib
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../matplotlib/example.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    示例
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_7_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../tensorflow/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    TensorFlow
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_7_5" id="__nav_5_7_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_7_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_7_5">
            <span class="md-nav__icon md-icon"></span>
            TensorFlow
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tensorflow/tensorflow.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TensorFlow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tensorflow/api-tf.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API: tf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tensorflow/api-config.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API: tf.config
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tensorflow/api-data.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API: tf.data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tensorflow/api-distribute.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API: tf.distribute
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tensorflow/api-image.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API: tf.image
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tensorflow/api-keras.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API: tf.keras
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tensorflow/api-linalg.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API: tf.linalg
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tensorflow/api-math.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API: tf.math
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tensorflow/api-random.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API: tf.random
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tensorflow/api-signal.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API: tf.signal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tensorflow/api-sparse.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API: tf.sparse
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tensorflow/api-strings.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API: tf.strings
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tensorflow/api-train.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API: tf.train
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tensorflow/api-tfds.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API: tfds
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_7_6" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    PyTorch
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_7_6" id="__nav_5_7_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_7_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_7_6">
            <span class="md-nav__icon md-icon"></span>
            PyTorch
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="pytorch.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="torchvision.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torchvision
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="torchserve.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    torchserve
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="api-torch.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API: torch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="api-nn.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API: torch.nn
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="api-nn-functional.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API: torch.nn.functional
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="api-optim.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API: torch.optim
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="api-autograd.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API: torch.autograd
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="api-cuda.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API: torch.cuda
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="api-backends.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API: torch.backends
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="api-distributed.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API: torch.distributed
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="api-multiprocessing.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API: torch.multiprocessing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="api-math.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API: torch.fft, torch.linalg, torch.special
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="api-sparse.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API: torch.sparse
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="api-utils-data.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API: torch.utils.data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="api-utils-tensorboard.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API: torch.utils.tensorboard
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="lightning.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lightning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    API: lightning
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="api-lightning.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    API: lightning
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#callbacks" class="md-nav__link">
    <span class="md-ellipsis">
      callbacks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="callbacks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#callback" class="md-nav__link">
    <span class="md-ellipsis">
      Callback
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#earlystopping" class="md-nav__link">
    <span class="md-ellipsis">
      EarlyStopping
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lambdacallback" class="md-nav__link">
    <span class="md-ellipsis">
      LambdaCallback
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#learningratemonitor" class="md-nav__link">
    <span class="md-ellipsis">
      LearningRateMonitor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modelcheckpoint" class="md-nav__link">
    <span class="md-ellipsis">
      ModelCheckpoint
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lightningmodule" class="md-nav__link">
    <span class="md-ellipsis">
      LightningModule
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LightningModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#current_epoch" class="md-nav__link">
    <span class="md-ellipsis">
      current_epoch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#device" class="md-nav__link">
    <span class="md-ellipsis">
      device
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#freeze" class="md-nav__link">
    <span class="md-ellipsis">
      freeze()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#global_rank" class="md-nav__link">
    <span class="md-ellipsis">
      global_rank
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#global_step" class="md-nav__link">
    <span class="md-ellipsis">
      global_step
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hparams" class="md-nav__link">
    <span class="md-ellipsis">
      hparams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load_from_checkpoint" class="md-nav__link">
    <span class="md-ellipsis">
      load_from_checkpoint()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#local_rank" class="md-nav__link">
    <span class="md-ellipsis">
      local_rank
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logger" class="md-nav__link">
    <span class="md-ellipsis">
      logger
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save_hyperparameters" class="md-nav__link">
    <span class="md-ellipsis">
      save_hyperparameters()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trainer" class="md-nav__link">
    <span class="md-ellipsis">
      trainer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unfreeze" class="md-nav__link">
    <span class="md-ellipsis">
      unfreeze()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lightningdatamodule" class="md-nav__link">
    <span class="md-ellipsis">
      LightningDataModule
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LightningDataModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prepare_data" class="md-nav__link">
    <span class="md-ellipsis">
      prepare_data()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    <span class="md-ellipsis">
      setup()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#loggers" class="md-nav__link">
    <span class="md-ellipsis">
      loggers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metrics" class="md-nav__link">
    <span class="md-ellipsis">
      metrics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="metrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#functional" class="md-nav__link">
    <span class="md-ellipsis">
      functional
    </span>
  </a>
  
    <nav class="md-nav" aria-label="functional">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#accuracy" class="md-nav__link">
    <span class="md-ellipsis">
      accuracy()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#confusion_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      confusion_matrix()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#precision-recall-precision_recall-f1" class="md-nav__link">
    <span class="md-ellipsis">
      precision(), recall(), precision_recall(), f1()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mean_absolute_error" class="md-nav__link">
    <span class="md-ellipsis">
      mean_absolute_error()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mean_squared_error" class="md-nav__link">
    <span class="md-ellipsis">
      mean_squared_error()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trainer_1" class="md-nav__link">
    <span class="md-ellipsis">
      Trainer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Trainer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#callback_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      callback_metrics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#current_epoch_1" class="md-nav__link">
    <span class="md-ellipsis">
      current_epoch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#init" class="md-nav__link">
    <span class="md-ellipsis">
      init()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="init()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#accelerator" class="md-nav__link">
    <span class="md-ellipsis">
      accelerator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accumulate_grad_batches" class="md-nav__link">
    <span class="md-ellipsis">
      accumulate_grad_batches
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automatic_optimization" class="md-nav__link">
    <span class="md-ellipsis">
      automatic_optimization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#auto_scale_batch_size" class="md-nav__link">
    <span class="md-ellipsis">
      auto_scale_batch_size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#auto_select_gpus" class="md-nav__link">
    <span class="md-ellipsis">
      auto_select_gpus
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#auto_lr_find" class="md-nav__link">
    <span class="md-ellipsis">
      auto_lr_find
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#callbacks_1" class="md-nav__link">
    <span class="md-ellipsis">
      callbacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check_val_every_n_epoch" class="md-nav__link">
    <span class="md-ellipsis">
      check_val_every_n_epoch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#checkpoint_callback" class="md-nav__link">
    <span class="md-ellipsis">
      checkpoint_callback
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#default_root_dir" class="md-nav__link">
    <span class="md-ellipsis">
      default_root_dir
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fast_dev_run" class="md-nav__link">
    <span class="md-ellipsis">
      fast_dev_run
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flush_logs_every_n_steps" class="md-nav__link">
    <span class="md-ellipsis">
      flush_logs_every_n_steps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gpus" class="md-nav__link">
    <span class="md-ellipsis">
      gpus
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#limit_train_batches" class="md-nav__link">
    <span class="md-ellipsis">
      limit_train_batches
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#limit_test_batches" class="md-nav__link">
    <span class="md-ellipsis">
      limit_test_batches
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#limit_val_batches" class="md-nav__link">
    <span class="md-ellipsis">
      limit_val_batches
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#log_every_n_steps" class="md-nav__link">
    <span class="md-ellipsis">
      log_every_n_steps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#log_gpu_memory" class="md-nav__link">
    <span class="md-ellipsis">
      log_gpu_memory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logger_1" class="md-nav__link">
    <span class="md-ellipsis">
      logger
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#max_epochs" class="md-nav__link">
    <span class="md-ellipsis">
      max_epochs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#min_epochs" class="md-nav__link">
    <span class="md-ellipsis">
      min_epochs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#max_steps" class="md-nav__link">
    <span class="md-ellipsis">
      max_steps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#min_steps" class="md-nav__link">
    <span class="md-ellipsis">
      min_steps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#num_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      num_nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#num_processes" class="md-nav__link">
    <span class="md-ellipsis">
      num_processes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#num_sanity_val_steps" class="md-nav__link">
    <span class="md-ellipsis">
      num_sanity_val_steps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#overfit_batches" class="md-nav__link">
    <span class="md-ellipsis">
      overfit_batches
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cluster_environment" class="md-nav__link">
    <span class="md-ellipsis">
      cluster_environment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prepare_data_per_node" class="md-nav__link">
    <span class="md-ellipsis">
      prepare_data_per_node
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#precision" class="md-nav__link">
    <span class="md-ellipsis">
      precision
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#profiler" class="md-nav__link">
    <span class="md-ellipsis">
      profiler
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#progress_bar_refresh_rate" class="md-nav__link">
    <span class="md-ellipsis">
      progress_bar_refresh_rate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reload_dataloaders_every_epoch" class="md-nav__link">
    <span class="md-ellipsis">
      reload_dataloaders_every_epoch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#replace_sampler_ddp" class="md-nav__link">
    <span class="md-ellipsis">
      replace_sampler_ddp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resume_from_checkpoint" class="md-nav__link">
    <span class="md-ellipsis">
      resume_from_checkpoint
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sync_batchnorm" class="md-nav__link">
    <span class="md-ellipsis">
      sync_batchnorm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#track_grad_norm" class="md-nav__link">
    <span class="md-ellipsis">
      track_grad_norm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#val_check_interval" class="md-nav__link">
    <span class="md-ellipsis">
      val_check_interval
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weights_save_path" class="md-nav__link">
    <span class="md-ellipsis">
      weights_save_path
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weights_summary" class="md-nav__link">
    <span class="md-ellipsis">
      weights_summary
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#is_global_zero" class="md-nav__link">
    <span class="md-ellipsis">
      is_global_zero
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#log_dir" class="md-nav__link">
    <span class="md-ellipsis">
      log_dir
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logger_2" class="md-nav__link">
    <span class="md-ellipsis">
      logger
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logged_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      logged_metrics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#progress_bar_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      progress_bar_metrics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test" class="md-nav__link">
    <span class="md-ellipsis">
      test()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tune" class="md-nav__link">
    <span class="md-ellipsis">
      tune()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../horovod.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    horovod
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_7_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../nni/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    nni
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_7_8" id="__nav_5_7_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_7_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_7_8">
            <span class="md-nav__icon md-icon"></span>
            nni
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nni/tuner.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    调参器
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  <span class="md-ellipsis">
    参考和工具
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            参考和工具
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" >
        
          
          <label class="md-nav__link" for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Linux
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1">
            <span class="md-nav__icon md-icon"></span>
            Linux
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference-and-tool/linux/linux-command.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linux 命令
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference-and-tool/linux/linux-command-line-tool.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linux 命令行工具
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2" >
        
          
          <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    文件格式
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            文件格式
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference-and-tool/file-format/json.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    json
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference-and-tool/file-format/yaml.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    yaml
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference-and-tool/file-format/xml.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    xml
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference-and-tool/file-format/markdown.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    markdown
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3" >
        
          
          <label class="md-nav__link" for="__nav_6_3" id="__nav_6_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    编码
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_3">
            <span class="md-nav__icon md-icon"></span>
            编码
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference-and-tool/encoding/charset-and-encoding.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    字符集和字符编码
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference-and-tool/encoding/base64.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Base64
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4" >
        
          
          <label class="md-nav__link" for="__nav_6_4" id="__nav_6_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    文本工具
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4">
            <span class="md-nav__icon md-icon"></span>
            文本工具
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference-and-tool/text-tool/regular-expression.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    正则表达式
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference-and-tool/text-tool/vim.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vim
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_5" >
        
          
          <label class="md-nav__link" for="__nav_6_5" id="__nav_6_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    构建工具
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_5">
            <span class="md-nav__icon md-icon"></span>
            构建工具
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference-and-tool/build-tool/make.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    make
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference-and-tool/git.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Git
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference-and-tool/vocabulary.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    词汇表
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  <span class="md-ellipsis">
    前端
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            前端
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../web/simple-html.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Simple HTML
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../web/simple-css.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Simple CSS
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#callbacks" class="md-nav__link">
    <span class="md-ellipsis">
      callbacks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="callbacks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#callback" class="md-nav__link">
    <span class="md-ellipsis">
      Callback
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#earlystopping" class="md-nav__link">
    <span class="md-ellipsis">
      EarlyStopping
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lambdacallback" class="md-nav__link">
    <span class="md-ellipsis">
      LambdaCallback
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#learningratemonitor" class="md-nav__link">
    <span class="md-ellipsis">
      LearningRateMonitor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modelcheckpoint" class="md-nav__link">
    <span class="md-ellipsis">
      ModelCheckpoint
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lightningmodule" class="md-nav__link">
    <span class="md-ellipsis">
      LightningModule
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LightningModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#current_epoch" class="md-nav__link">
    <span class="md-ellipsis">
      current_epoch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#device" class="md-nav__link">
    <span class="md-ellipsis">
      device
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#freeze" class="md-nav__link">
    <span class="md-ellipsis">
      freeze()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#global_rank" class="md-nav__link">
    <span class="md-ellipsis">
      global_rank
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#global_step" class="md-nav__link">
    <span class="md-ellipsis">
      global_step
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hparams" class="md-nav__link">
    <span class="md-ellipsis">
      hparams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load_from_checkpoint" class="md-nav__link">
    <span class="md-ellipsis">
      load_from_checkpoint()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#local_rank" class="md-nav__link">
    <span class="md-ellipsis">
      local_rank
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logger" class="md-nav__link">
    <span class="md-ellipsis">
      logger
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save_hyperparameters" class="md-nav__link">
    <span class="md-ellipsis">
      save_hyperparameters()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trainer" class="md-nav__link">
    <span class="md-ellipsis">
      trainer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unfreeze" class="md-nav__link">
    <span class="md-ellipsis">
      unfreeze()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lightningdatamodule" class="md-nav__link">
    <span class="md-ellipsis">
      LightningDataModule
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LightningDataModule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prepare_data" class="md-nav__link">
    <span class="md-ellipsis">
      prepare_data()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    <span class="md-ellipsis">
      setup()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#loggers" class="md-nav__link">
    <span class="md-ellipsis">
      loggers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metrics" class="md-nav__link">
    <span class="md-ellipsis">
      metrics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="metrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#functional" class="md-nav__link">
    <span class="md-ellipsis">
      functional
    </span>
  </a>
  
    <nav class="md-nav" aria-label="functional">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#accuracy" class="md-nav__link">
    <span class="md-ellipsis">
      accuracy()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#confusion_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      confusion_matrix()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#precision-recall-precision_recall-f1" class="md-nav__link">
    <span class="md-ellipsis">
      precision(), recall(), precision_recall(), f1()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mean_absolute_error" class="md-nav__link">
    <span class="md-ellipsis">
      mean_absolute_error()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mean_squared_error" class="md-nav__link">
    <span class="md-ellipsis">
      mean_squared_error()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trainer_1" class="md-nav__link">
    <span class="md-ellipsis">
      Trainer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Trainer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#callback_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      callback_metrics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#current_epoch_1" class="md-nav__link">
    <span class="md-ellipsis">
      current_epoch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#init" class="md-nav__link">
    <span class="md-ellipsis">
      init()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="init()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#accelerator" class="md-nav__link">
    <span class="md-ellipsis">
      accelerator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accumulate_grad_batches" class="md-nav__link">
    <span class="md-ellipsis">
      accumulate_grad_batches
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automatic_optimization" class="md-nav__link">
    <span class="md-ellipsis">
      automatic_optimization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#auto_scale_batch_size" class="md-nav__link">
    <span class="md-ellipsis">
      auto_scale_batch_size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#auto_select_gpus" class="md-nav__link">
    <span class="md-ellipsis">
      auto_select_gpus
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#auto_lr_find" class="md-nav__link">
    <span class="md-ellipsis">
      auto_lr_find
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#callbacks_1" class="md-nav__link">
    <span class="md-ellipsis">
      callbacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check_val_every_n_epoch" class="md-nav__link">
    <span class="md-ellipsis">
      check_val_every_n_epoch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#checkpoint_callback" class="md-nav__link">
    <span class="md-ellipsis">
      checkpoint_callback
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#default_root_dir" class="md-nav__link">
    <span class="md-ellipsis">
      default_root_dir
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fast_dev_run" class="md-nav__link">
    <span class="md-ellipsis">
      fast_dev_run
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flush_logs_every_n_steps" class="md-nav__link">
    <span class="md-ellipsis">
      flush_logs_every_n_steps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gpus" class="md-nav__link">
    <span class="md-ellipsis">
      gpus
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#limit_train_batches" class="md-nav__link">
    <span class="md-ellipsis">
      limit_train_batches
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#limit_test_batches" class="md-nav__link">
    <span class="md-ellipsis">
      limit_test_batches
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#limit_val_batches" class="md-nav__link">
    <span class="md-ellipsis">
      limit_val_batches
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#log_every_n_steps" class="md-nav__link">
    <span class="md-ellipsis">
      log_every_n_steps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#log_gpu_memory" class="md-nav__link">
    <span class="md-ellipsis">
      log_gpu_memory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logger_1" class="md-nav__link">
    <span class="md-ellipsis">
      logger
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#max_epochs" class="md-nav__link">
    <span class="md-ellipsis">
      max_epochs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#min_epochs" class="md-nav__link">
    <span class="md-ellipsis">
      min_epochs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#max_steps" class="md-nav__link">
    <span class="md-ellipsis">
      max_steps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#min_steps" class="md-nav__link">
    <span class="md-ellipsis">
      min_steps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#num_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      num_nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#num_processes" class="md-nav__link">
    <span class="md-ellipsis">
      num_processes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#num_sanity_val_steps" class="md-nav__link">
    <span class="md-ellipsis">
      num_sanity_val_steps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#overfit_batches" class="md-nav__link">
    <span class="md-ellipsis">
      overfit_batches
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cluster_environment" class="md-nav__link">
    <span class="md-ellipsis">
      cluster_environment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prepare_data_per_node" class="md-nav__link">
    <span class="md-ellipsis">
      prepare_data_per_node
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#precision" class="md-nav__link">
    <span class="md-ellipsis">
      precision
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#profiler" class="md-nav__link">
    <span class="md-ellipsis">
      profiler
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#progress_bar_refresh_rate" class="md-nav__link">
    <span class="md-ellipsis">
      progress_bar_refresh_rate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reload_dataloaders_every_epoch" class="md-nav__link">
    <span class="md-ellipsis">
      reload_dataloaders_every_epoch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#replace_sampler_ddp" class="md-nav__link">
    <span class="md-ellipsis">
      replace_sampler_ddp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resume_from_checkpoint" class="md-nav__link">
    <span class="md-ellipsis">
      resume_from_checkpoint
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sync_batchnorm" class="md-nav__link">
    <span class="md-ellipsis">
      sync_batchnorm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#track_grad_norm" class="md-nav__link">
    <span class="md-ellipsis">
      track_grad_norm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#val_check_interval" class="md-nav__link">
    <span class="md-ellipsis">
      val_check_interval
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weights_save_path" class="md-nav__link">
    <span class="md-ellipsis">
      weights_save_path
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weights_summary" class="md-nav__link">
    <span class="md-ellipsis">
      weights_summary
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#is_global_zero" class="md-nav__link">
    <span class="md-ellipsis">
      is_global_zero
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#log_dir" class="md-nav__link">
    <span class="md-ellipsis">
      log_dir
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logger_2" class="md-nav__link">
    <span class="md-ellipsis">
      logger
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logged_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      logged_metrics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#progress_bar_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      progress_bar_metrics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test" class="md-nav__link">
    <span class="md-ellipsis">
      test()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tune" class="md-nav__link">
    <span class="md-ellipsis">
      tune()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="pytorch_lightning">pytorch_lightning<a class="headerlink" href="#pytorch_lightning" title="Permanent link">&para;</a></h1>
<h2 id="callbacks">callbacks<a class="headerlink" href="#callbacks" title="Permanent link">&para;</a></h2>
<div class="admonition note">
<p class="admonition-title">注意</p>
<p><code>keras.callbacks</code> 同时对应于 <code>pytorch_lightning.callbacks</code> 和 <code>pytorch_lightning.loggers</code>。</p>
</div>
<h3 id="callback">Callback<a class="headerlink" href="#callback" title="Permanent link">&para;</a></h3>
<p>用于创建新回调的抽象类。若要创建回调，继承此类并任意重载以下方法：</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">CustomCallback</span><span class="p">(</span><span class="n">pytorch_lightning</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">Callback</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">on_before_accelerator_backend_setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">:</span> <span class="n">LightningModule</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called before accelerator is being setup&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">:</span> <span class="n">LightningModule</span><span class="p">,</span> <span class="n">stage</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called when fit, validate, test, predict, or tune begins&quot;&quot;&quot;</span>
        <span class="c1"># 当训练/测试开始时调用</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">teardown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">:</span> <span class="n">LightningModule</span><span class="p">,</span> <span class="n">stage</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called when fit, validate, test, predict, or tune ends&quot;&quot;&quot;</span>
        <span class="c1"># 当训练/测试结束时调用,全部结束时亦调用一次</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">on_init_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called when the trainer initialization begins, model has not yet been set.&quot;&quot;&quot;</span>
        <span class="c1"># 当训练器初始化开始时调用,此时模型尚未设置</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">on_init_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called when the trainer initialization ends, model has not yet been set.&quot;&quot;&quot;</span>
        <span class="c1"># 当训练器初始化结束时调用,此时模型尚未设置</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">on_fit_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">:</span> <span class="n">LightningModule</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called when fit begins&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">on_fit_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">:</span> <span class="n">LightningModule</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called when fit ends&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">on_sanity_check_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">:</span> <span class="n">LightningModule</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called when the validation sanity check starts.&quot;&quot;&quot;</span>
        <span class="c1"># 当验证集可用性检查开始时调用</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">on_sanity_check_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">:</span> <span class="n">LightningModule</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called when the validation sanity check ends.&quot;&quot;&quot;</span>
        <span class="c1"># 当验证集可用性检查结束时调用</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">on_train_batch_start</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">:</span> <span class="n">LightningModule</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">dataloader_idx</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called when the train batch begins.&quot;&quot;&quot;</span>
        <span class="c1"># 当训练batch开始时调用</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">on_train_batch_end</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">:</span> <span class="n">LightningModule</span><span class="p">,</span> <span class="n">outputs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">dataloader_idx</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called when the train batch ends.&quot;&quot;&quot;</span>
        <span class="c1"># 当训练batch结束时调用</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">on_train_epoch_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">:</span> <span class="n">LightningModule</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called when the train epoch begins.&quot;&quot;&quot;</span>
        <span class="c1"># 当训练epoch开始时调用</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">on_train_epoch_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">:</span> <span class="n">LightningModule</span><span class="p">,</span> <span class="n">outputs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called when the train epoch ends.&quot;&quot;&quot;</span>
        <span class="c1"># 当训练epoch结束时调用</span>
        <span class="c1"># 调用`trainer.callback_metrics`得到当前训练epoch的`train_loss`和前一个验证epoch的`val_loss`和`val_acc`</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">on_validation_epoch_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">:</span> <span class="n">LightningModule</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called when the val epoch begins.&quot;&quot;&quot;</span>
        <span class="c1"># 当验证epoch开始时调用</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">on_validation_epoch_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">:</span> <span class="n">LightningModule</span><span class="p">,</span> <span class="n">outputs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called when the val epoch ends.&quot;&quot;&quot;</span>
        <span class="c1"># 当验证epoch结束时调用</span>
        <span class="c1"># outputs参数可能接受不到任何值,建议写为outputs=None</span>
        <span class="c1"># 调用`trainer.callback_metrics`得到当前训练epoch的`train_loss`和当前验证epoch的`val_loss`和`val_acc`</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">on_test_epoch_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">:</span> <span class="n">LightningModule</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called when the test epoch begins.&quot;&quot;&quot;</span>
        <span class="c1"># 当测试epoch开始时调用</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">on_test_epoch_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">:</span> <span class="n">LightningModule</span><span class="p">,</span> <span class="n">outputs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called when the test epoch ends.&quot;&quot;&quot;</span>
        <span class="c1"># 当测试epoch结束时调用</span>
        <span class="c1"># 调用trainer.callback_metrics得到测试epoch的test_loss和test_acc以及最后一个训练+验证epoch的</span>
        <span class="c1">#     train_loss, val_loss和val_acc</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">on_epoch_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">:</span> <span class="n">LightningModule</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called when the epoch begins.&quot;&quot;&quot;</span>
        <span class="c1"># 当(训练/测试)epoch开始时调用</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">on_epoch_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">:</span> <span class="n">LightningModule</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called when the epoch ends.&quot;&quot;&quot;</span>
        <span class="c1"># 当(训练/验证/测试)epoch结束时调用</span>
        <span class="c1"># 调用trainer.callback_metrics的结果与其之前的on_train_epoch_end, on_validation_epoch_end, </span>
        <span class="c1">#     on_test_epoch_end相同</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">on_batch_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">:</span> <span class="n">LightningModule</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called when the training batch begins.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">on_validation_batch_start</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">:</span> <span class="n">LightningModule</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">dataloader_idx</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called when the validation batch begins.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">on_validation_batch_end</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">:</span> <span class="n">LightningModule</span><span class="p">,</span> <span class="n">outputs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">dataloader_idx</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called when the validation batch ends.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">on_test_batch_start</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">:</span> <span class="n">LightningModule</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">dataloader_idx</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called when the test batch begins.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">on_test_batch_end</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">:</span> <span class="n">LightningModule</span><span class="p">,</span> <span class="n">outputs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">dataloader_idx</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called when the test batch ends.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">on_batch_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">:</span> <span class="n">LightningModule</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called when the training batch ends.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">on_train_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">:</span> <span class="n">LightningModule</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called when the train begins.&quot;&quot;&quot;</span>
        <span class="c1"># 当训练开始时调用</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">on_train_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">:</span> <span class="n">LightningModule</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called when the train ends.&quot;&quot;&quot;</span>
        <span class="c1"># 当训练结束时调用</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">on_pretrain_routine_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">:</span> <span class="n">LightningModule</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called when the pretrain routine begins.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">on_pretrain_routine_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">:</span> <span class="n">LightningModule</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called when the pretrain routine ends.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">on_validation_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">:</span> <span class="n">LightningModule</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called when the validation loop begins.&quot;&quot;&quot;</span>
        <span class="c1"># 当验证开始时调用</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">on_validation_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">:</span> <span class="n">LightningModule</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called when the validation loop ends.&quot;&quot;&quot;</span>
        <span class="c1"># 当验证结束时调用</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">on_test_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">:</span> <span class="n">LightningModule</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called when the test begins.&quot;&quot;&quot;</span>
        <span class="c1"># 当测试开始时调用</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">on_test_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">:</span> <span class="n">LightningModule</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called when the test ends.&quot;&quot;&quot;</span>
        <span class="c1"># 当测试结束时调用</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">on_keyboard_interrupt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">:</span> <span class="n">LightningModule</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called when the training is interrupted by ``KeyboardInterrupt``.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">on_save_checkpoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">:</span> <span class="n">LightningModule</span><span class="p">,</span> <span class="n">checkpoint</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Called when saving a model checkpoint, use to persist state.</span>
<span class="sd">        Args:</span>
<span class="sd">            trainer: the current Trainer instance.</span>
<span class="sd">            pl_module: the current LightningModule instance.</span>
<span class="sd">            checkpoint: the checkpoint dictionary that will be saved.</span>
<span class="sd">        Returns:</span>
<span class="sd">            The callback state.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">on_load_checkpoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback_state</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called when loading a model checkpoint, use to reload state.</span>
<span class="sd">        Args:</span>
<span class="sd">            callback_state: the callback state returned by ``on_save_checkpoint``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">on_after_backward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">:</span> <span class="n">LightningModule</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called after ``loss.backward()`` and before optimizers do anything.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">on_before_zero_grad</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">:</span> <span class="n">LightningModule</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called after ``optimizer.step()`` and before ``optimizer.zero_grad()``.&quot;&quot;&quot;</span>
        <span class="k">pass</span>
</code></pre></div>
<p>调用的顺序如下：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>python<span class="w"> </span>mnist_lambdacallback.py
GPU<span class="w"> </span>available:<span class="w"> </span>False,<span class="w"> </span>used:<span class="w"> </span>False
TPU<span class="w"> </span>available:<span class="w"> </span>None,<span class="w"> </span>using:<span class="w"> </span><span class="m">0</span><span class="w"> </span>TPU<span class="w"> </span>cores

init<span class="w"> </span>start<span class="w"> </span>...<span class="w">                   </span><span class="c1"># 训练器初始化</span>
init<span class="w"> </span>end<span class="w"> </span>...

setup<span class="w"> </span>...<span class="w">                        </span><span class="c1"># setup</span>
fit<span class="w"> </span>start<span class="w"> </span>...

<span class="w">  </span><span class="p">|</span><span class="w"> </span>Name<span class="w">  </span><span class="p">|</span><span class="w"> </span>Type<span class="w">       </span><span class="p">|</span><span class="w"> </span>Params
-------------------------------------
<span class="m">0</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>model<span class="w"> </span><span class="p">|</span><span class="w"> </span>Sequential<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">55</span>.1<span class="w"> </span>K
-------------------------------------
<span class="m">55</span>.1<span class="w"> </span>K<span class="w">    </span>Trainable<span class="w"> </span>params
<span class="m">0</span><span class="w">         </span>Non-trainable<span class="w"> </span>params
<span class="m">55</span>.1<span class="w"> </span>K<span class="w">    </span>Total<span class="w"> </span>params
<span class="m">0</span>.220<span class="w">     </span>Total<span class="w"> </span>estimated<span class="w"> </span>model<span class="w"> </span>params<span class="w"> </span>size<span class="w"> </span><span class="o">(</span>MB<span class="o">)</span>

validation<span class="w"> </span>start<span class="w"> </span>...<span class="w">              </span><span class="c1"># 验证集测试</span>
validation<span class="w"> </span>epoch<span class="w"> </span>start<span class="w"> </span>...
validation<span class="w"> </span>epoch<span class="w"> </span>end<span class="w"> </span>...
epoch<span class="w"> </span>end<span class="w"> </span>...
validation<span class="w"> </span>end<span class="w"> </span>...

train<span class="w"> </span>start<span class="w"> </span>...<span class="w">                   </span><span class="c1"># 训练开始</span>

epoch<span class="w"> </span>start<span class="w"> </span>...<span class="w">                   </span><span class="c1"># 一个训练+验证epoch</span>
train<span class="w"> </span>epoch<span class="w"> </span>start<span class="w"> </span>...
train<span class="w"> </span>epoch<span class="w"> </span>end<span class="w"> </span>...
epoch<span class="w"> </span>end<span class="w"> </span>...
validation<span class="w"> </span>start<span class="w"> </span>...
validation<span class="w"> </span>epoch<span class="w"> </span>start<span class="w"> </span>...
validation<span class="w"> </span>epoch<span class="w"> </span>end<span class="w"> </span>...
epoch<span class="w"> </span>end<span class="w"> </span>...
validation<span class="w"> </span>end<span class="w"> </span>...

epoch<span class="w"> </span>start<span class="w"> </span>...
train<span class="w"> </span>epoch<span class="w"> </span>start<span class="w"> </span>...
train<span class="w"> </span>epoch<span class="w"> </span>end<span class="w"> </span>...
epoch<span class="w"> </span>end<span class="w"> </span>...
validation<span class="w"> </span>start<span class="w"> </span>...
validation<span class="w"> </span>epoch<span class="w"> </span>start<span class="w"> </span>...
validation<span class="w"> </span>epoch<span class="w"> </span>end<span class="w"> </span>...
epoch<span class="w"> </span>end<span class="w"> </span>...
validation<span class="w"> </span>end<span class="w"> </span>...

epoch<span class="w"> </span>start<span class="w"> </span>...
train<span class="w"> </span>epoch<span class="w"> </span>start<span class="w"> </span>...
train<span class="w"> </span>epoch<span class="w"> </span>end<span class="w"> </span>...
epoch<span class="w"> </span>end<span class="w"> </span>...
validation<span class="w"> </span>start<span class="w"> </span>...
validation<span class="w"> </span>epoch<span class="w"> </span>start<span class="w"> </span>...
validation<span class="w"> </span>epoch<span class="w"> </span>end<span class="w"> </span>...
epoch<span class="w"> </span>end<span class="w"> </span>...
validation<span class="w"> </span>end<span class="w"> </span>...

train<span class="w"> </span>end<span class="w"> </span>...<span class="w">                     </span><span class="c1"># 训练结束</span>

fit<span class="w"> </span>end<span class="w"> </span>...
teardown<span class="w"> </span>...<span class="w">                      </span><span class="c1"># teardown</span>

setup<span class="w"> </span>...<span class="w">                         </span><span class="c1"># setup</span>
fit<span class="w"> </span>start<span class="w"> </span>...

<span class="nb">test</span><span class="w"> </span>start<span class="w"> </span>...<span class="w">                    </span><span class="c1"># 测试开始</span>

<span class="nb">test</span><span class="w"> </span>epoch<span class="w"> </span>start<span class="w"> </span>...<span class="w">              </span><span class="c1"># 一个测试epoch</span>
<span class="nb">test</span><span class="w"> </span>epoch<span class="w"> </span>end<span class="w"> </span>...
epoch<span class="w"> </span>end<span class="w"> </span>...

<span class="nb">test</span><span class="w"> </span>end<span class="w"> </span>...<span class="w">                      </span><span class="c1"># 测试结束</span>

--------------------------------------------------------------------------------
DATALOADER:0<span class="w"> </span>TEST<span class="w"> </span>RESULTS
<span class="o">{</span><span class="s1">&#39;test_acc&#39;</span>:<span class="w"> </span><span class="m">0</span>.9527999758720398,<span class="w"> </span><span class="s1">&#39;test_loss&#39;</span>:<span class="w"> </span><span class="m">0</span>.14726394414901733<span class="o">}</span>
--------------------------------------------------------------------------------

fit<span class="w"> </span>end<span class="w"> </span>...
teardown<span class="w"> </span>...<span class="w">                      </span><span class="c1"># teardown</span>

teardown<span class="w"> </span>...
</code></pre></div>
<h3 id="earlystopping">EarlyStopping<a class="headerlink" href="#earlystopping" title="Permanent link">&para;</a></h3>
<p>当监视的参数不再改善时提前停止训练。</p>
<div class="highlight"><pre><span></span><code><span class="n">pytorch_lightning</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">EarlyStopping</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;early_stop_on&#39;</span><span class="p">,</span> <span class="n">min_delta</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">check_finite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stopping_threshold</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">divergence_threshold</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">check_on_train_epoch_end</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1"># monitor               监视的指标</span>
<span class="c1"># min_delta             可以视为改善的最小绝对变化量,换言之,小于该值的指标绝对变化量视为没有改善</span>
<span class="c1"># patience              若最近patience次epoch的指标都没有改善(即最后patience次的指标都比倒数第patience+1次差),则停止训练</span>
<span class="c1"># mode                  若为&#39;min&#39;,则指标减小视为改善;若为&#39;max&#39;,则指标增加视为改善;若为&#39;auto&#39;,则方向根据指标的名称自动推断</span>
<span class="c1"># strict                若为True,则当监视的指标不存在时抛出异常</span>
</code></pre></div>
<h3 id="lambdacallback">LambdaCallback<a class="headerlink" href="#lambdacallback" title="Permanent link">&para;</a></h3>
<p>创建简单的自定义回调。</p>
<div class="highlight"><pre><span></span><code><span class="n">pytorch_lightning</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">LambdaCallback</span><span class="p">(</span><span class="n">on_before_accelerator_backend_setup</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">setup</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">teardown</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_init_start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_init_end</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_fit_start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_fit_end</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_sanity_check_start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_sanity_check_end</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_train_batch_start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_train_batch_end</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_train_epoch_start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_train_epoch_end</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_validation_epoch_start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_validation_epoch_end</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_test_epoch_start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_test_epoch_end</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_epoch_start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_epoch_end</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_batch_start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_validation_batch_start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_validation_batch_end</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_test_batch_start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_test_batch_end</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_batch_end</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_train_start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_train_end</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_pretrain_routine_start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_pretrain_routine_end</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_validation_start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_validation_end</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_test_start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_test_end</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_keyboard_interrupt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_save_checkpoint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_load_checkpoint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_after_backward</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_before_zero_grad</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="c1"># on_before_accelerator_backend_setup...   参见`Callback`</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pytorch_lightning</span> <span class="kn">import</span> <span class="n">Trainer</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pytorch_lightning.callbacks</span> <span class="kn">import</span> <span class="n">LambdaCallback</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">LambdaCallback</span><span class="p">(</span><span class="n">setup</span><span class="o">=</span><span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;setup&#39;</span><span class="p">))])</span>
</code></pre></div>
<h3 id="learningratemonitor">LearningRateMonitor<a class="headerlink" href="#learningratemonitor" title="Permanent link">&para;</a></h3>
<h3 id="modelcheckpoint">ModelCheckpoint<a class="headerlink" href="#modelcheckpoint" title="Permanent link">&para;</a></h3>
<h2 id="lightningmodule">LightningModule<a class="headerlink" href="#lightningmodule" title="Permanent link">&para;</a></h2>
<p><code>LightningModule</code> 类汇集了一个模型的所有方面，继承此类……</p>
<h3 id="current_epoch">current_epoch<a class="headerlink" href="#current_epoch" title="Permanent link">&para;</a></h3>
<p>当前 epoch 的序号。</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">training_step</span><span class="p">(</span><span class="o">...</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_epoch</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</code></pre></div>
<h3 id="device">device<a class="headerlink" href="#device" title="Permanent link">&para;</a></h3>
<p>此模块位于的设备。</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">training_step</span><span class="p">(</span><span class="o">...</span><span class="p">):</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</code></pre></div>
<h3 id="freeze">freeze()<a class="headerlink" href="#freeze" title="Permanent link">&para;</a></h3>
<p>冻结所有参数以推断。</p>
<h3 id="global_rank">global_rank<a class="headerlink" href="#global_rank" title="Permanent link">&para;</a></h3>
<p>此模块的全局 rank。Lightning 仅从 global_rank=0 保存日志、权重等。</p>
<p>全局 rank 表示所有 GPU 之中的 GPU 索引。例如，使用 10 台机器，每台有 4 个 GPU，那么第 10 台机器的第 4 个 GPU 有 global_rank=39。</p>
<h3 id="global_step">global_step<a class="headerlink" href="#global_step" title="Permanent link">&para;</a></h3>
<p>当前 step 的序号（每个 epoch 不重置）。</p>
<h3 id="hparams">hparams<a class="headerlink" href="#hparams" title="Permanent link">&para;</a></h3>
<p>通过调用 <code>save_hyperparameters()</code> 保存的模型超参数。</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">learning_rate</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">save_hyperparameters</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">configure_optimizers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Adam</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">hparams</span><span class="o">.</span><span class="n">learning_rate</span><span class="p">)</span>
</code></pre></div>
<h3 id="load_from_checkpoint">load_from_checkpoint()<a class="headerlink" href="#load_from_checkpoint" title="Permanent link">&para;</a></h3>
<p>从检查点加载模型的主要方法。当 Lightning 保存检查点时，其将构造函数的参数保存在检查点的 <code>hyper_parameters</code> 键下。</p>
<p>任何通过 <code>**kwargs</code> 传入的参数都将重载保存在 <code>hyper_parameters</code> 下的参数。</p>
<div class="highlight"><pre><span></span><code><span class="nb">classmethod</span> <span class="n">LightningModule</span><span class="o">.</span><span class="n">load_from_checkpoint</span><span class="p">(</span><span class="n">checkpoint_path</span><span class="p">,</span> <span class="n">map_location</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hparams_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="c1"># checkpoint_path  检查点的路径,可以是url或类似文件的对象</span>
<span class="c1"># map_location     如果你保存了一个GPU模型并在CPU或者不同数量的GPU上加载,使用此参数...</span>
<span class="c1"># hparam_file      一个yaml文件的路径,其包含了模型超参数值</span>
<span class="c1">#                  一般用不到,因为超参数会自动保存到检查点中</span>
<span class="c1"># strict           ...</span>
<span class="c1"># kwargs           初始化模型的额外参数,用于重载已保存的超参数值</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># 直接加载</span>
<span class="n">MyLightningModule</span><span class="o">.</span><span class="n">load_from_checkpoint</span><span class="p">(</span><span class="s1">&#39;path/to/checkpoint.ckpt&#39;</span><span class="p">)</span>

<span class="c1"># 将所有权重从GPU1映射到GPU0</span>
<span class="n">map_location</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;cuda:1&#39;</span><span class="p">:</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">}</span>
<span class="n">MyLightningModule</span><span class="o">.</span><span class="n">load_from_checkpoint</span><span class="p">(</span>
    <span class="s1">&#39;path/to/checkpoint.ckpt&#39;</span><span class="p">,</span>
    <span class="n">map_location</span><span class="o">=</span><span class="n">map_location</span>
<span class="p">)</span>

<span class="c1"># 从不同文件分别加载权重和超参数</span>
<span class="n">MyLightningModule</span><span class="o">.</span><span class="n">load_from_checkpoint</span><span class="p">(</span>
    <span class="s1">&#39;path/to/checkpoint.ckpt&#39;</span><span class="p">,</span>
    <span class="n">hparams_file</span><span class="o">=</span><span class="s1">&#39;/path/to/hparams_file.yaml&#39;</span>
<span class="p">)</span>

<span class="c1"># 重载部分超参数</span>
<span class="n">MyLightningModule</span><span class="o">.</span><span class="n">load_from_checkpoint</span><span class="p">(</span>
    <span class="n">PATH</span><span class="p">,</span>
    <span class="n">num_layers</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
    <span class="n">pretrained_ckpt_path</span><span class="p">:</span> <span class="n">NEW_PATH</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># 预测</span>
<span class="n">pretrained_model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="n">pretrained_model</span><span class="o">.</span><span class="n">freeze</span><span class="p">()</span>
<span class="n">y_hat</span> <span class="o">=</span> <span class="n">pretrained_model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>
<h3 id="local_rank">local_rank<a class="headerlink" href="#local_rank" title="Permanent link">&para;</a></h3>
<p>此模块的局部 rank。Lightning 仅从 global_rank=0 保存日志、权重等。</p>
<p>局部 rank 表示当前机器的 GPU 索引。例如，使用 10 台机器，每台有 4 个 GPU，那么第 10 台机器的第 4 个 GPU 有 local_rank=3。</p>
<h3 id="logger">logger<a class="headerlink" href="#logger" title="Permanent link">&para;</a></h3>
<p>当前使用的日志器。</p>
<h3 id="save_hyperparameters">save_hyperparameters()<a class="headerlink" href="#save_hyperparameters" title="Permanent link">&para;</a></h3>
<p>将模型超参数保存至 <code>hparams</code> 属性。</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">ManuallyArgsModel</span><span class="p">(</span><span class="n">LightningModule</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">,</span> <span class="n">arg3</span><span class="p">):</span>
<span class="o">...</span>         <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="o">...</span>         <span class="bp">self</span><span class="o">.</span><span class="n">save_hyperparameters</span><span class="p">(</span><span class="s1">&#39;arg1&#39;</span><span class="p">,</span> <span class="s1">&#39;arg3&#39;</span><span class="p">)</span>   <span class="c1"># 保存指定参数</span>
<span class="o">...</span>     <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="o">...</span>         <span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">model</span> <span class="o">=</span> <span class="n">ManuallyArgsModel</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;abc&#39;</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">model</span><span class="o">.</span><span class="n">hparams</span>
<span class="s2">&quot;arg1&quot;</span><span class="p">:</span> <span class="mi">1</span>
<span class="s2">&quot;arg3&quot;</span><span class="p">:</span> <span class="mf">3.14</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">AutomaticArgsModel</span><span class="p">(</span><span class="n">LightningModule</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">,</span> <span class="n">arg3</span><span class="p">):</span>
<span class="o">...</span>         <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="o">...</span>         <span class="bp">self</span><span class="o">.</span><span class="n">save_hyperparameters</span><span class="p">()</span>                 <span class="c1"># 保存构造函数的所有参数</span>
<span class="o">...</span>     <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="o">...</span>         <span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">model</span> <span class="o">=</span> <span class="n">AutomaticArgsModel</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;abc&#39;</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">model</span><span class="o">.</span><span class="n">hparams</span>
<span class="s2">&quot;arg1&quot;</span><span class="p">:</span> <span class="mi">1</span>
<span class="s2">&quot;arg2&quot;</span><span class="p">:</span> <span class="n">abc</span>
<span class="s2">&quot;arg3&quot;</span><span class="p">:</span> <span class="mf">3.14</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">ManuallyArgsModel</span><span class="p">(</span><span class="n">LightningModule</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">,</span> <span class="n">arg3</span><span class="p">):</span>
<span class="o">...</span>         <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="o">...</span>         <span class="bp">self</span><span class="o">.</span><span class="n">save_hyperparameters</span><span class="p">(</span><span class="n">ignore</span><span class="o">=</span><span class="s1">&#39;arg2&#39;</span><span class="p">)</span>    <span class="c1"># 忽略指定参数</span>
<span class="o">...</span>     <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="o">...</span>         <span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">model</span> <span class="o">=</span> <span class="n">ManuallyArgsModel</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;abc&#39;</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">model</span><span class="o">.</span><span class="n">hparams</span>
<span class="s2">&quot;arg1&quot;</span><span class="p">:</span> <span class="mi">1</span>
<span class="s2">&quot;arg3&quot;</span><span class="p">:</span> <span class="mf">3.14</span>
</code></pre></div>
<h3 id="trainer">trainer<a class="headerlink" href="#trainer" title="Permanent link">&para;</a></h3>
<p>当前使用的训练器。</p>
<h3 id="unfreeze">unfreeze()<a class="headerlink" href="#unfreeze" title="Permanent link">&para;</a></h3>
<p>解冻所有参数以训练。</p>
<h2 id="lightningdatamodule">LightningDataModule<a class="headerlink" href="#lightningdatamodule" title="Permanent link">&para;</a></h2>
<p><code>LightningDataModule</code> 类用于组织数据处理的代码以使得复用更加容易，继承此类……</p>
<h3 id="prepare_data">prepare_data()<a class="headerlink" href="#prepare_data" title="Permanent link">&para;</a></h3>
<h3 id="setup">setup()<a class="headerlink" href="#setup" title="Permanent link">&para;</a></h3>
<h2 id="loggers">loggers<a class="headerlink" href="#loggers" title="Permanent link">&para;</a></h2>
<blockquote>
<p>注意 <code>keras.callbacks</code> 同时对应 <code>pytorch_lightning.callbacks</code> 和 <code>pytorch_lightning.loggers</code>。</p>
</blockquote>
<h2 id="metrics">metrics<a class="headerlink" href="#metrics" title="Permanent link">&para;</a></h2>
<h3 id="functional">functional<a class="headerlink" href="#functional" title="Permanent link">&para;</a></h3>
<h4 id="accuracy">accuracy()<a class="headerlink" href="#accuracy" title="Permanent link">&para;</a></h4>
<p>计算准确率。</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pytorch_lightning.metrics.functional</span> <span class="kn">import</span> <span class="n">accuracy</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">accuracy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">tensor</span><span class="p">(</span><span class="mf">0.5000</span><span class="p">)</span>
</code></pre></div>
<h4 id="confusion_matrix">confusion_matrix()<a class="headerlink" href="#confusion_matrix" title="Permanent link">&para;</a></h4>
<p>计算混淆矩阵。</p>
<p>见 precision（），recall（），precision_recall（），f1（）。</p>
<h4 id="precision-recall-precision_recall-f1">precision(), recall(), precision_recall(), f1()<a class="headerlink" href="#precision-recall-precision_recall-f1" title="Permanent link">&para;</a></h4>
<p>计算精确率、召回率、F1 值。对比 sklearn 包的相关函数。</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">torch</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pytorch_lightning.metrics.functional</span> <span class="kn">import</span> <span class="n">precision</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pytorch_lightning.metrics.functional</span> <span class="kn">import</span> <span class="n">recall</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pytorch_lightning.metrics.functional</span> <span class="kn">import</span> <span class="n">precision_recall</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pytorch_lightning.metrics.functional</span> <span class="kn">import</span> <span class="n">f1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pytorch_lightning.metrics.functional</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y_true</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>  <span class="c1"># 二分类</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">num_classes</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># 必须传入num_classes参数</span>
<span class="c1"># pred   0   1</span>
<span class="n">tensor</span><span class="p">([[</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">],</span>   <span class="c1"># true  0</span>
        <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">]])</span>  <span class="c1">#       1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">precision</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">class_reduction</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>  <span class="c1"># 不分辨阴阳性,对每个类型计算</span>
<span class="n">tensor</span><span class="p">([</span><span class="mf">0.6667</span><span class="p">,</span> <span class="mf">0.6000</span><span class="p">])</span>
<span class="c1">#       0       1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">recall</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">class_reduction</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">tensor</span><span class="p">([</span><span class="mf">0.5000</span><span class="p">,</span> <span class="mf">0.7500</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">precision_recall</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">class_reduction</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="p">(</span><span class="n">tensor</span><span class="p">([</span><span class="mf">0.6667</span><span class="p">,</span> <span class="mf">0.6000</span><span class="p">]),</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">0.5000</span><span class="p">,</span> <span class="mf">0.7500</span><span class="p">]))</span>   <span class="c1"># (precision, recall)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f1</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">num_classes</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">tensor</span><span class="p">([</span><span class="mf">0.5714</span><span class="p">,</span> <span class="mf">0.6667</span><span class="p">])</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">torch</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pytorch_lightning.metrics.functional</span> <span class="kn">import</span> <span class="n">precision</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pytorch_lightning.metrics.functional</span> <span class="kn">import</span> <span class="n">recall</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pytorch_lightning.metrics.functional</span> <span class="kn">import</span> <span class="n">precision_recall</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pytorch_lightning.metrics.functional</span> <span class="kn">import</span> <span class="n">f1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pytorch_lightning.metrics.functional</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y_true</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>  <span class="c1"># 多分类</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">num_classes</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="c1"># pred   0   1   2</span>
<span class="n">tensor</span><span class="p">([[</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>   <span class="c1"># true  0</span>
        <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>   <span class="c1">#       1</span>
        <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>  <span class="c1">#       2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">precision</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">class_reduction</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">tensor</span><span class="p">([</span><span class="mf">0.7500</span><span class="p">,</span> <span class="mf">0.5000</span><span class="p">,</span> <span class="mf">1.0000</span><span class="p">])</span>   <span class="c1"># 分别对于pred(列) 0,1,2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">precision</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">class_reduction</span><span class="o">=</span><span class="s1">&#39;macro&#39;</span><span class="p">)</span>
<span class="n">tensor</span><span class="p">(</span><span class="mf">0.7500</span><span class="p">)</span>                     <span class="c1"># 宏平均</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">precision</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">class_reduction</span><span class="o">=</span><span class="s1">&#39;micro&#39;</span><span class="p">)</span>
<span class="n">tensor</span><span class="p">(</span><span class="mf">0.6667</span><span class="p">)</span>                     <span class="c1"># 微平均</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">recall</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">class_reduction</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">tensor</span><span class="p">([</span><span class="mf">1.0000</span><span class="p">,</span> <span class="mf">0.6667</span><span class="p">,</span> <span class="mf">0.3333</span><span class="p">])</span>   <span class="c1"># 分别对于true(行) 0,1,2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">recall</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">class_reduction</span><span class="o">=</span><span class="s1">&#39;macro&#39;</span><span class="p">)</span>
<span class="n">tensor</span><span class="p">(</span><span class="mf">0.6667</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">recall</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">class_reduction</span><span class="o">=</span><span class="s1">&#39;micro&#39;</span><span class="p">)</span>
<span class="n">tensor</span><span class="p">(</span><span class="mf">0.6667</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">precision_recall</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">class_reduction</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="p">(</span><span class="n">tensor</span><span class="p">([</span><span class="mf">0.7500</span><span class="p">,</span> <span class="mf">0.5000</span><span class="p">,</span> <span class="mf">1.0000</span><span class="p">]),</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">1.0000</span><span class="p">,</span> <span class="mf">0.6667</span><span class="p">,</span> <span class="mf">0.3333</span><span class="p">]))</span> 
<span class="o">&gt;&gt;&gt;</span> <span class="n">precision_recall</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">class_reduction</span><span class="o">=</span><span class="s1">&#39;macro&#39;</span><span class="p">)</span>
<span class="p">(</span><span class="n">tensor</span><span class="p">(</span><span class="mf">0.7500</span><span class="p">),</span> <span class="n">tensor</span><span class="p">(</span><span class="mf">0.6667</span><span class="p">))</span>   <span class="c1"># (precision, recall)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">precision_recall</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">class_reduction</span><span class="o">=</span><span class="s1">&#39;micro&#39;</span><span class="p">)</span>
<span class="p">(</span><span class="n">tensor</span><span class="p">(</span><span class="mf">0.6667</span><span class="p">),</span> <span class="n">tensor</span><span class="p">(</span><span class="mf">0.6667</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f1</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">num_classes</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">tensor</span><span class="p">([</span><span class="mf">0.8571</span><span class="p">,</span> <span class="mf">0.5714</span><span class="p">,</span> <span class="mf">0.5000</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f1</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">num_classes</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;macro&#39;</span><span class="p">)</span>
<span class="n">tensor</span><span class="p">(</span><span class="mf">0.6429</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f1</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">num_classes</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;micro&#39;</span><span class="p">)</span>
<span class="n">tensor</span><span class="p">(</span><span class="mf">0.6667</span><span class="p">)</span>
</code></pre></div>
<h4 id="mean_absolute_error">mean_absolute_error()<a class="headerlink" href="#mean_absolute_error" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pytorch_lightning.metrics.functional</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">10.0</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a2</span> <span class="o">=</span> <span class="n">a1</span><span class="o">+</span><span class="mi">2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">)</span>
<span class="n">tensor</span><span class="p">(</span><span class="mf">2.</span><span class="p">)</span>
</code></pre></div>
<h4 id="mean_squared_error">mean_squared_error()<a class="headerlink" href="#mean_squared_error" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pytorch_lightning.metrics.functional</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">10.0</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a2</span> <span class="o">=</span> <span class="n">a1</span><span class="o">+</span><span class="mi">2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">)</span>
<span class="n">tensor</span><span class="p">(</span><span class="mf">4.</span><span class="p">)</span>
</code></pre></div>
<h2 id="trainer_1">Trainer<a class="headerlink" href="#trainer_1" title="Permanent link">&para;</a></h2>
<h3 id="callback_metrics">callback_metrics<a class="headerlink" href="#callback_metrics" title="Permanent link">&para;</a></h3>
<p>回调可用的指标，是一个字典对象。</p>
<p>每个训练 epoch 结束时更新 <code>train_loss</code> 指标，每个验证 epoch 结束时更新 <code>val_loss</code> 和 <code>val_acc</code> 指标，每个测试 epoch 结束时更新 <code>test_loss</code> 和 <code>test_acc</code> 指标；也可以调用 <code>self.log</code> 自动设置指标。</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">training_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batcbh_idx</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;a_val&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">trainer</span><span class="o">.</span><span class="n">callback_metrics</span><span class="p">[</span><span class="s1">&#39;a_val&#39;</span><span class="p">]</span>  <span class="c1"># 2</span>
</code></pre></div>
<h3 id="current_epoch_1">current_epoch<a class="headerlink" href="#current_epoch_1" title="Permanent link">&para;</a></h3>
<p>当前 epoch 序数。</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">training_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">):</span>
    <span class="n">current_epoch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trainer</span><span class="o">.</span><span class="n">current_epoch</span>
    <span class="k">if</span> <span class="n">current_epoch</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
        <span class="c1"># do something</span>
        <span class="k">pass</span>
</code></pre></div>
<h3 id="fit">fit()<a class="headerlink" href="#fit" title="Permanent link">&para;</a></h3>
<p>运行完整的优化步骤。</p>
<p>使用方法参考<a href="lightning.html#验证">验证</a>。</p>
<h3 id="init">init()<a class="headerlink" href="#init" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">Trainer</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
    <span class="n">logger</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">checkpoint_callback</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_root_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">gradient_clip_val</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">process_position</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_nodes</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_processes</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">gpus</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">auto_select_gpus</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tpu_cores</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">log_gpu_memory</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">progress_bar_refresh_rate</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">overfit_batches</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">track_grad_norm</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">check_val_every_n_epoch</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fast_dev_run</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">accumulate_grad_batches</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">max_epochs</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">min_epochs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_steps</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">min_steps</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">limit_train_batches</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">limit_val_batches</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">limit_test_batches</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">val_check_interval</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">flush_logs_every_n_steps</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">log_every_n_steps</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">accelerator</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sync_batchnorm</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">weights_summary</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span>
    <span class="n">weights_save_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_sanity_val_steps</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">truncated_bptt_steps</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">resume_from_checkpoint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">profiler</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">benchmark</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">deterministic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">reload_dataloaders_every_epoch</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">auto_lr_find</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">replace_sampler_ddp</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">terminate_on_nan</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">auto_scale_batch_size</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">prepare_data_per_node</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plugins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">amp_backend</span><span class="o">=</span><span class="s1">&#39;native&#39;</span><span class="p">,</span>
    <span class="n">amp_level</span><span class="o">=</span><span class="s1">&#39;O2&#39;</span><span class="p">,</span> <span class="n">distributed_backend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">automatic_optimization</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">move_metrics_to_cpu</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">enable_pl_optimizer</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>
<h4 id="accelerator">accelerator<a class="headerlink" href="#accelerator" title="Permanent link">&para;</a></h4>
<p>使用的加速器后端。</p>
<ul>
<li><code>dp</code>：DataParallel，将 batch 划分给一台机器上的多个 GPU</li>
<li><code>ddp</code>：DistributedDataParallel，每台节点上的每个 GPU 进行训练，并同步梯度</li>
<li><code>ddp_cpu</code>：CPU 上的 DistributedDataParallel，与 <code>ddp</code> 相同，但不使用 GPU，用于多节点 CPU 训练。注意这对于单个节点没有加速作用，因为 Torch 已经能够充分运用单机的多个 CPU（核）。</li>
<li><code>ddp2</code>：在节点上使用 dp，在节点间使用 ddp</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1"># default used by the Trainer</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">accelerator</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="c1"># dp = DataParallel</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">gpus</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">accelerator</span><span class="o">=</span><span class="s1">&#39;dp&#39;</span><span class="p">)</span>

<span class="c1"># ddp = DistributedDataParallel</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">gpus</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">num_nodes</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">accelerator</span><span class="o">=</span><span class="s1">&#39;ddp&#39;</span><span class="p">)</span>

<span class="c1"># ddp2 = DistributedDataParallel + dp</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">gpus</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">num_nodes</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">accelerator</span><span class="o">=</span><span class="s1">&#39;ddp2&#39;</span><span class="p">)</span>
</code></pre></div>
<h4 id="accumulate_grad_batches">accumulate_grad_batches<a class="headerlink" href="#accumulate_grad_batches" title="Permanent link">&para;</a></h4>
<p>每 k 个 batch 累积梯度，trainer 会在最后一个 step 调用 <code>optimizer.step()</code>。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># default used by the Trainer (no accumulation)</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">accumulate_grad_batches</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># accumulate every 4 batches (effective batch size is batch*4)</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">accumulate_grad_batches</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># accumulate 3 from epoch 5, accumulate 20 from epoch 10</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">accumulate_grad_batches</span><span class="o">=</span><span class="p">{</span><span class="mi">5</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="mi">20</span><span class="p">})</span>
</code></pre></div>
<p><code>accumulate_grad_batches=4</code> 等效于 4 倍的 batch size，但区别在于前者占用更小的显存，后者花费更少的时间。例如你的显存不足以训练 batch size=64，但足以训练 batch size=32，就可以通过设置 <code>accumulate_grad_batches=2</code> 等效实现 batch size=64。</p>
<h4 id="automatic_optimization">automatic_optimization<a class="headerlink" href="#automatic_optimization" title="Permanent link">&para;</a></h4>
<p>若设为 <code>False</code>，则禁用 Lightning 的自动优化过程，此时你需要负责你自己的优化器行为。</p>
<p>当只使用一个优化器时不推荐禁用，但当使用两个优化器并且你是一个专业用户时推荐禁用。通常用于强化学习、稀疏编码和 GAN 研究。</p>
<h4 id="auto_scale_batch_size">auto_scale_batch_size<a class="headerlink" href="#auto_scale_batch_size" title="Permanent link">&para;</a></h4>
<p>自动尝试显存所能接受的最大 batch size。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># default used by the Trainer (no scaling of batch size)</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">auto_scale_batch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="c1"># run batch size scaling, result overrides hparams.batch_size</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">auto_scale_batch_size</span><span class="o">=</span><span class="s1">&#39;binsearch&#39;</span><span class="p">)</span>

<span class="c1"># call tune to find the batch size</span>
<span class="n">trainer</span><span class="o">.</span><span class="n">tune</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</code></pre></div>
<blockquote>
<p>注意使用batch的初衷是让优化算法的效果更好，而非充分利用GPU的计算资源。可以假定GPU的运行速度受batch size的影响不大。</p>
</blockquote>
<h4 id="auto_select_gpus">auto_select_gpus<a class="headerlink" href="#auto_select_gpus" title="Permanent link">&para;</a></h4>
<p>若设为 <code>True</code> 且 <code>gpus</code> 是一个整数，自动选择可用的 GPU。当 GPU 都被设置为独占模式（exclusive mode）时（即同一时刻只有一个进程能访问它），这尤其有用。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># no auto selection (picks first 2 gpus on system, may fail if other process is occupying)</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">gpus</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">auto_select_gpus</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># enable auto selection (will find two available gpus on system)</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">gpus</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">auto_select_gpus</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># specifies all GPUs regardless of its availability</span>
<span class="n">Trainer</span><span class="p">(</span><span class="n">gpus</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">auto_select_gpus</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># specifies all available GPUs (if only one GPU is not occupied, uses one gpu)</span>
<span class="n">Trainer</span><span class="p">(</span><span class="n">gpus</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">auto_select_gpus</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
<h4 id="auto_lr_find">auto_lr_find<a class="headerlink" href="#auto_lr_find" title="Permanent link">&para;</a></h4>
<p>当调用 <code>trainer.tune()</code> 时运行一个学习率查找算法（参考<a href="https://arxiv.org/abs/1506.01186">论文</a>），以寻找最优初始学习率。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># default used by the Trainer (no learning rate finder)</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">auto_lr_find</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># run learning rate finder, results override hparams.learning_rate</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">auto_lr_find</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># call tune to find the lr</span>
<span class="n">trainer</span><span class="o">.</span><span class="n">tune</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="c1"># run learning rate finder, results override hparams.my_lr_arg</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">auto_lr_find</span><span class="o">=</span><span class="s1">&#39;my_lr_arg&#39;</span><span class="p">)</span>
<span class="c1"># call tune to find the lr</span>
<span class="n">trainer</span><span class="o">.</span><span class="n">tune</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</code></pre></div>
<h4 id="callbacks_1">callbacks<a class="headerlink" href="#callbacks_1" title="Permanent link">&para;</a></h4>
<p>添加一个回调列表。</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">pytorch_lightning.callbacks</span> <span class="kn">import</span> <span class="n">Callback</span>

<span class="k">class</span> <span class="nc">PrintCallback</span><span class="p">(</span><span class="n">Callback</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">on_train_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Training is started!&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">on_train_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">pl_module</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Training is done.&quot;</span><span class="p">)</span>

<span class="n">callbacks</span> <span class="o">=</span> <span class="p">[</span><span class="n">PrintCallback</span><span class="p">()]</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">callbacks</span><span class="o">=</span><span class="n">callbacks</span><span class="p">)</span>        
</code></pre></div>
<h4 id="check_val_every_n_epoch">check_val_every_n_epoch<a class="headerlink" href="#check_val_every_n_epoch" title="Permanent link">&para;</a></h4>
<p>每 n 个训练 epoch 运行一次验证 epoch。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># default used by the Trainer</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">check_val_every_n_epoch</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># run val loop every 10 training epochs</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">check_val_every_n_epoch</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div>
<p>参见提前停止。</p>
<h4 id="checkpoint_callback">checkpoint_callback<a class="headerlink" href="#checkpoint_callback" title="Permanent link">&para;</a></h4>
<p>默认情况下 Lightning 保存最后一个训练 epoch 的状态为检查点，在当前工作目录下。设为 <code>False</code> 以禁用自动保存检查点。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># default used by Trainer</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">checkpoint_callback</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># turn off automatic checkpointing</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">checkpoint_callback</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>
<p>你可以使用 <code>ModelCheckpoint</code> 回调重载默认行为，参考保存和加载权重。</p>
<h4 id="default_root_dir">default_root_dir<a class="headerlink" href="#default_root_dir" title="Permanent link">&para;</a></h4>
<p>日志和检查点的默认存放路径，如果不传入日志器、<code>ModelCheckpoint</code> 回调或 <code>weights_save_path</code> 参数。有些集群需要分别存储日志和检查点，如果你不需要，则可以简单地使用此参数。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># default used by the Trainer</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">default_root_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
</code></pre></div>
<blockquote>
<p>详细的路径规则参考日志和保存和加载权重。</p>
</blockquote>
<h4 id="fast_dev_run">fast_dev_run<a class="headerlink" href="#fast_dev_run" title="Permanent link">&para;</a></h4>
<p>快速测试训练、验证和测试是否有 bug，是一种单元测试。设为 <code>True</code> 时运行 1 个训练、验证、测试 batch，设为 n（正整数）时运行 n 个训练、验证、测试 batch，设为 <code>False</code> 时不运行。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># default used by the Trainer</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">fast_dev_run</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># runs 1 train, val, test batch and program ends</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">fast_dev_run</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># runs 7 train, val, test batches and program ends</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">fast_dev_run</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</code></pre></div>
<h4 id="flush_logs_every_n_steps">flush_logs_every_n_steps<a class="headerlink" href="#flush_logs_every_n_steps" title="Permanent link">&para;</a></h4>
<p>将日志写入磁盘的频率。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># default used by the Trainer</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">flush_logs_every_n_steps</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</code></pre></div>
<h4 id="gpus">gpus<a class="headerlink" href="#gpus" title="Permanent link">&para;</a></h4>
<p>使用的 GPU。参考多 GPU 训练。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># default used by the Trainer (ie: train on CPU)</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">gpus</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="c1"># equivalent</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">gpus</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># int: train on 2 gpus</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">gpus</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># list: train on GPUs 1, 4 (by bus ordering)</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">gpus</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">gpus</span><span class="o">=</span><span class="s1">&#39;1, 4&#39;</span><span class="p">)</span> <span class="c1"># equivalent</span>

<span class="c1"># -1: train on all gpus</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">gpus</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">gpus</span><span class="o">=</span><span class="s1">&#39;-1&#39;</span><span class="p">)</span> <span class="c1"># equivalent</span>

<span class="c1"># combine with num_nodes to train on multiple GPUs across nodes</span>
<span class="c1"># uses 8 gpus in total</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">gpus</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">num_nodes</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># train only on GPUs 1 and 4 across nodes</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">gpus</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">num_nodes</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div>
<h4 id="limit_train_batches">limit_train_batches<a class="headerlink" href="#limit_train_batches" title="Permanent link">&para;</a></h4>
<p>每个训练 epoch 仅运行指定比例的训练集或指定数量的 batch，用于 debug 或测试。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># default used by the Trainer</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">limit_train_batches</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>

<span class="c1"># run through only 25% of the training set each epoch</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">limit_train_batches</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>

<span class="c1"># run through only 10 batches of the training set each epoch</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">limit_train_batches</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div>
<h4 id="limit_test_batches">limit_test_batches<a class="headerlink" href="#limit_test_batches" title="Permanent link">&para;</a></h4>
<p>同上。</p>
<h4 id="limit_val_batches">limit_val_batches<a class="headerlink" href="#limit_val_batches" title="Permanent link">&para;</a></h4>
<p>同上。</p>
<h4 id="log_every_n_steps">log_every_n_steps<a class="headerlink" href="#log_every_n_steps" title="Permanent link">&para;</a></h4>
<p>增加日志行的频率。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># default used by the Trainer</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">log_every_n_steps</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</code></pre></div>
<h4 id="log_gpu_memory">log_gpu_memory<a class="headerlink" href="#log_gpu_memory" title="Permanent link">&para;</a></h4>
<p>记录显存占用（使用 <code>nvidia-smi</code> 的输出）。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># default used by the Trainer</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">log_gpu_memory</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="c1"># log all the GPUs (on master node only)</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">log_gpu_memory</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>

<span class="c1"># log only the min and max memory on the master node</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">log_gpu_memory</span><span class="o">=</span><span class="s1">&#39;min_max&#39;</span><span class="p">)</span>
</code></pre></div>
<h4 id="logger_1">logger<a class="headerlink" href="#logger_1" title="Permanent link">&para;</a></h4>
<p>日志器。</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">pytorch_lightning.loggers</span> <span class="kn">import</span> <span class="n">TensorBoardLogger</span>

<span class="c1"># default logger used by trainer</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">TensorBoardLogger</span><span class="p">(</span>
    <span class="n">save_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span>
    <span class="n">version</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;lightning_logs&#39;</span>
<span class="p">)</span>
<span class="n">Trainer</span><span class="p">(</span><span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</code></pre></div>
<h4 id="max_epochs">max_epochs<a class="headerlink" href="#max_epochs" title="Permanent link">&para;</a></h4>
<p>最大训练 epoch 数。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># default used by the Trainer</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">max_epochs</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</code></pre></div>
<h4 id="min_epochs">min_epochs<a class="headerlink" href="#min_epochs" title="Permanent link">&para;</a></h4>
<p>最小训练 epoch 数。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># default used by the Trainer</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">min_epochs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<h4 id="max_steps">max_steps<a class="headerlink" href="#max_steps" title="Permanent link">&para;</a></h4>
<p>最大训练 step 数。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Default (disabled)</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">max_steps</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="c1"># Stop after 100 steps</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">max_steps</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</code></pre></div>
<p>当 <code>max_epochs</code> 或 <code>max_steps</code> 之一达到时，训练即终止。</p>
<h4 id="min_steps">min_steps<a class="headerlink" href="#min_steps" title="Permanent link">&para;</a></h4>
<p>最小训练 step 数。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Default (disabled)</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">min_steps</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="c1"># Run at least for 100 steps (disable min_epochs)</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">min_steps</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">min_epochs</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div>
<p>训练数需要同时达到 <code>min_epochs</code> 和 <code>min_steps</code>。</p>
<h4 id="num_nodes">num_nodes<a class="headerlink" href="#num_nodes" title="Permanent link">&para;</a></h4>
<p>分布式训练使用的 GPU 节点。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># default used by the Trainer</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># to train on 8 nodes</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</code></pre></div>
<h4 id="num_processes">num_processes<a class="headerlink" href="#num_processes" title="Permanent link">&para;</a></h4>
<p>训练的进程数。当使用 <code>accelerator="ddp"</code> 时自动设置为 GPU 的数量。当使用 <code>accelerator="ddp_cpu"</code> 时，设置大于 1 的数可以在一台没有 GPU 的机器上模拟分布式训练。这对于 debug 有用，但不会有任何加速效果，因为 PyTorch 的单进程已经可以充分利用多核 CPU。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Simulate DDP for debugging on your GPU-less laptop</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">accelerator</span><span class="o">=</span><span class="s2">&quot;ddp_cpu&quot;</span><span class="p">,</span> <span class="n">num_processes</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div>
<h4 id="num_sanity_val_steps">num_sanity_val_steps<a class="headerlink" href="#num_sanity_val_steps" title="Permanent link">&para;</a></h4>
<p>在训练开始前对验证集的 n 个 batch 进行合法性检查，用于快速检查验证过程的 bug 而不用等待第一个验证 epoch。默认使用 2 个 step。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># default used by the Trainer</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">num_sanity_val_steps</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># turn it off</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">num_sanity_val_steps</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># check all validation data</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">num_sanity_val_steps</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<p>合法性检查完成后会重置验证 dataloader。</p>
<h4 id="overfit_batches">overfit_batches<a class="headerlink" href="#overfit_batches" title="Permanent link">&para;</a></h4>
<p>仅使用训练集的指定比例或指定数量的样本，并且用其进行验证和测试。如果训练 dataloader 有 <code>shuffle=True</code>，Lightning 会自动禁用之。</p>
<p>用于快速 debug 或故意实现过拟合。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># default used by the Trainer</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">overfit_batches</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>

<span class="c1"># use only 1% of the train set (and use the train set for val and test)</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">overfit_batches</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="c1"># overfit on 10 of the same batches</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">overfit_batches</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div>
<h4 id="cluster_environment">cluster_environment<a class="headerlink" href="#cluster_environment" title="Permanent link">&para;</a></h4>
<h4 id="prepare_data_per_node">prepare_data_per_node<a class="headerlink" href="#prepare_data_per_node" title="Permanent link">&para;</a></h4>
<p>若为 <code>True</code> 则在每个节点的 <code>LOCAL_RANK=0</code> 上调用 <code>prepare_data()</code>，若为 <code>False</code> 则仅在 <code>NODE_RANK=0,LOCAL_RANK=0</code> 上调用。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># default</span>
<span class="n">Trainer</span><span class="p">(</span><span class="n">prepare_data_per_node</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># use only NODE_RANK=0, LOCAL_RANK=0</span>
<span class="n">Trainer</span><span class="p">(</span><span class="n">prepare_data_per_node</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>
<h4 id="precision">precision<a class="headerlink" href="#precision" title="Permanent link">&para;</a></h4>
<p>使用全精度（32）或半精度（16），可以用在 CPU，GPU 或 TPU 上。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># default used by the Trainer</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>

<span class="c1"># 16-bit precision</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
</code></pre></div>
<h4 id="profiler">profiler<a class="headerlink" href="#profiler" title="Permanent link">&para;</a></h4>
<p>打印训练事件和统计信息，用于帮助寻找性能上的瓶颈。</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">pytorch_lightning.profiler</span> <span class="kn">import</span> <span class="n">SimpleProfiler</span><span class="p">,</span> <span class="n">AdvancedProfiler</span>

<span class="c1"># default used by the Trainer</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">profiler</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="c1"># to profile standard training events, equivalent to `profiler=SimpleProfiler()`</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">profiler</span><span class="o">=</span><span class="s2">&quot;simple&quot;</span><span class="p">)</span>

<span class="c1"># advanced profiler for function-level stats, equivalent to `profiler=AdvancedProfiler()`</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">profiler</span><span class="o">=</span><span class="s2">&quot;advanced&quot;</span><span class="p">)</span>
</code></pre></div>
<h4 id="progress_bar_refresh_rate">progress_bar_refresh_rate<a class="headerlink" href="#progress_bar_refresh_rate" title="Permanent link">&para;</a></h4>
<p>刷新进度条的频率。已知 notebook 由于屏幕刷新率的问题，使用高刷新率（低数值）会造成崩溃，建议赋值 50 以上。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># default used by the Trainer</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">progress_bar_refresh_rate</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># disable progress bar</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">progress_bar_refresh_rate</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div>
<h4 id="reload_dataloaders_every_epoch">reload_dataloaders_every_epoch<a class="headerlink" href="#reload_dataloaders_every_epoch" title="Permanent link">&para;</a></h4>
<p>若为 <code>True</code>，则每个 epoch 都重新加载一个 dataloader。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># if False (default)</span>
<span class="n">train_loader</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">train_dataloader</span><span class="p">()</span>
<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="n">epochs</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">train_loader</span><span class="p">:</span>
        <span class="o">...</span>

<span class="c1"># if True</span>
<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="n">epochs</span><span class="p">:</span>
    <span class="n">train_loader</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">train_dataloader</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">train_loader</span><span class="p">:</span>
</code></pre></div>
<h4 id="replace_sampler_ddp">replace_sampler_ddp<a class="headerlink" href="#replace_sampler_ddp" title="Permanent link">&para;</a></h4>
<h4 id="resume_from_checkpoint">resume_from_checkpoint<a class="headerlink" href="#resume_from_checkpoint" title="Permanent link">&para;</a></h4>
<p>从路径指定的检查点恢复训练。如果恢复的检查点训练到一个 epoch 半途，则训练从下一个 epoch 开始。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># default used by the Trainer</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">resume_from_checkpoint</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="c1"># resume from a specific checkpoint</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">resume_from_checkpoint</span><span class="o">=</span><span class="s1">&#39;some/path/to/my_checkpoint.ckpt&#39;</span><span class="p">)</span>
</code></pre></div>
<h4 id="sync_batchnorm">sync_batchnorm<a class="headerlink" href="#sync_batchnorm" title="Permanent link">&para;</a></h4>
<h4 id="track_grad_norm">track_grad_norm<a class="headerlink" href="#track_grad_norm" title="Permanent link">&para;</a></h4>
<h4 id="val_check_interval">val_check_interval<a class="headerlink" href="#val_check_interval" title="Permanent link">&para;</a></h4>
<p>一个训练 epoch 中插入验证 epoch 的次数，可以指定浮点数或整数。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># default used by the Trainer</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">val_check_interval</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>

<span class="c1"># check validation set 4 times during a training epoch</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">val_check_interval</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>

<span class="c1"># check validation set every 1000 training batches</span>
<span class="c1"># use this when using iterableDataset and your dataset has no length</span>
<span class="c1"># (ie: production cases with streaming data)</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">val_check_interval</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</code></pre></div>
<h4 id="weights_save_path">weights_save_path<a class="headerlink" href="#weights_save_path" title="Permanent link">&para;</a></h4>
<p>保存权重的目录。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># default used by the Trainer</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">weights_save_path</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>

<span class="c1"># save to your custom path</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">weights_save_path</span><span class="o">=</span><span class="s1">&#39;my/path&#39;</span><span class="p">)</span>
</code></pre></div>
<blockquote>
<p>详细的路径规则参考日志和保存和加载权重。</p>
</blockquote>
<h4 id="weights_summary">weights_summary<a class="headerlink" href="#weights_summary" title="Permanent link">&para;</a></h4>
<p>训练开始前打印模型参数的摘要，选项包含 <code>'full','top',None</code>。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># default used by the Trainer (ie: print summary of top level modules)</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">weights_summary</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">)</span>

<span class="c1"># print full summary of all modules and submodules</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">weights_summary</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">)</span>

<span class="c1"># don&#39;t print a summary</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">weights_summary</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>
<h3 id="is_global_zero">is_global_zero<a class="headerlink" href="#is_global_zero" title="Permanent link">&para;</a></h3>
<p>确认当前进程是否为多节点训练的全局零。</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">training_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trainer</span><span class="o">.</span><span class="n">is_global_zero</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;in node 0, accelerator 0&#39;</span><span class="p">)</span>
</code></pre></div>
<h3 id="log_dir">log_dir<a class="headerlink" href="#log_dir" title="Permanent link">&para;</a></h3>
<p>日志的保存路径，用于保存图片等。</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">training_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">):</span>
    <span class="n">img</span> <span class="o">=</span> <span class="o">...</span>
    <span class="n">save_img</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">trainer</span><span class="o">.</span><span class="n">log_dir</span><span class="p">)</span>
</code></pre></div>
<h3 id="logger_2">logger<a class="headerlink" href="#logger_2" title="Permanent link">&para;</a></h3>
<p>当前使用的日志器。</p>
<h3 id="logged_metrics">logged_metrics<a class="headerlink" href="#logged_metrics" title="Permanent link">&para;</a></h3>
<p>发送到日志器的指标。</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">training_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;a_val&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">trainer</span><span class="o">.</span><span class="n">logged_metrics</span><span class="p">[</span><span class="s1">&#39;a_val&#39;</span><span class="p">]</span>  <span class="c1"># 2</span>
</code></pre></div>
<h3 id="progress_bar_metrics">progress_bar_metrics<a class="headerlink" href="#progress_bar_metrics" title="Permanent link">&para;</a></h3>
<p>发送到进度条的指标。</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">training_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;a_val&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">prog_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">trainer</span><span class="o">.</span><span class="n">progress_bar_metrics</span><span class="p">[</span><span class="s1">&#39;a_val&#39;</span><span class="p">]</span>  <span class="c1"># 2</span>
</code></pre></div>
<h3 id="test">test()<a class="headerlink" href="#test" title="Permanent link">&para;</a></h3>
<p>运行测试步骤。与优化步骤分离。</p>
<p>使用方法参考<a href="lightning.html#测试">测试</a>。</p>
<h3 id="tune">tune()<a class="headerlink" href="#tune" title="Permanent link">&para;</a></h3>
<p>在训练之前运行调整超参数的步骤，例如 <code>auto_lr_find,auto_scale_batch_size</code>。</p>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="最后更新">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"/></svg>
    </span>
    2023-12-11
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.indexes", "navigation.tabs", "navigation.top", "search.highlight", "search.share", "search.suggest"], "search": "../../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.d7c377c4.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="../../../javascripts/tex-mml-chtml.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.cs/net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>