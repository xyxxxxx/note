# 样本空间和事件

随机试验 $E$ 的每个可能结果称为**样本点**，所有样本点的集合称为该试验的**样本空间**，记为 $S$。

<br/>

@试验“抛一枚骰子，观察出现的点数”的样本空间为
$$
S=\{1,2,3,4,5,6\}
$$

<br/>

样本空间 $S$ 的任意子集 $A$ 称为一个**事件(event)**。如果试验的结果在 $A$ 之中，就称事件 $A$ 发生。特别地，由一个样本点组成的子集称为**基本事件**。

$S$ 自身包含每次试验的结果，因此总是发生，称为**必然事件**；空集 $\varnothing$ 不包含任何试验结果，因此永远不会发生，称为**不可能事件(null event)**。

<br/>

@试验“抛一枚骰子，观察出现的点数”中， $A=\{2,4,6\}$ 表示事件“骰子点数为偶数”。

<br/>

事件 $A$ **包含**事件 $B$ 记作 $B\sub A$，表示事件 $B$ 的发生必定导致事件 $A$ 发生。若 $B\sub A,A\sub B$，即 $A=B$，则称事件 $A$ 和事件 $B$ **相等**。

事件 $A$ 和事件 $B$ 的**并集(union)** 记作 $A\cup B$， $A\cup B$ 发生当且仅当事件 $A$ 和事件 $B$ 至少有一个发生。事件 $A$ 和事件 $B$ 的**交集(intersection)** 记作 $A\cap B$ 或 $AB$， $AB$ 发生当且仅当事件 $A$ 和事件 $B$ 同时发生。 $\bigcup_{k=1}^nA_k$ 为事件 $A_1,A_2,\cdots,A_n$ 的并集， $\bigcap_{k=1}^nA_k$ 为事件 $A_1,A_2,\cdots,A_n$ 的交集。

事件 $A$ 和事件 $B$ 的**差集**记作 $A-B$， $A-B$ 发生当且仅当事件 $A$ 发生且事件 $B$ 不发生。

如果 $AB=\varnothing$，则称 $A$ 与 $B$ **互不相容(mutually exclusive)**。如果 $AB=\varnothing,A\cup B=S$，则称 $A$ 与 $B$ 互为**对立事件(complement)**；对于任意事件 $A$，总存在一个它的对立事件 $\overline{A}$，由样本空间中不属于 $A$ 的所有结果构成。

# 概率

考察一个以 $S$ 为样本空间的试验，对于 $S$ 的每一个事件 $A$，我们定义一个满足以下条件的数 $P(A)$ :

1. $0\le P(A)\le 1$ 
2. $P(S)=1$ 
3. 对于满足 $i\neq j\Rightarrow A_iA_j=\varnothing$ 的事件序列 $\{A_n\}$，有

$$
P(\bigcup_{n=1}^\infty A_n)=\sum_{n=1}^\infty P(A_n)
$$

$P(A)$ 称为事件 $A$ 的**概率(probability)**。若 $P(A)=P(B)$，则称事件 $A$ 和 $B$ 的发生是等可能的。

根据定义，概率具有以下性质：

* $P(\varnothing)=0$ 

* $P(\bigcup_{i=1}^n A_i)=\sum_{i=1}^n P(A_i)$ 

* 若 $A\sub B$，则 $P(B-A)=P(B)-P(A)$ 

* $P(\overline{A})=1-P(A)$ 

* 考虑 $P(A\cup B)$：

  $$
  \because P(A)=P((A-B)\cup AB)=P(A-B)+P(AB)\\
  \because P(B)=P((B-A)\cup AB)=P(B-A)+P(AB)\\
  \therefore P(A\cup B)=P((A-B)\cup AB\cup (B-A))=P(A-B)+P(AB)+P(B-A)\\
  =P(A)+P(B)-P(AB)
  $$

  事实上，由归纳法可以证明

  $$
  P(A_1\cup A_2\cdots\cup A_n)=\sum_i P(A_i)-\sum_{i<j}P(A_iA_j)+\sum_{i<j<k}P(A_iA_jA_k)-\cdots+(-1)^{n+1}P(A_1A_2\cdots A_n)
  $$

  上式即为**容斥原理**。

<br/>

@试验“掷骰子”中，事件“骰子点数为偶数”的概率为
$$
P(\{2,4,6\})=P(\{2\})+P(\{4\})+P(\{6\})=\frac{1}{2}
$$

> 均匀的骰子可以定义为，一次试验中事件“骰子点数为1”，“骰子点数为2”，……，“骰子点数为6”的概率相等的骰子。

# 等可能概型（古典概型）

前面提到的掷骰子试验具有以下特点：

1. 试验的样本空间只包含有限样本点
2. 试验中每个基本事件的发生是等可能的

这种试验称为**等可能概型**，由于它曾是概率论发展初期的主要研究对象，因此也称为**古典概型**。等可能概型的概念具有直观、容易理解的特点。

等可能概型中，设试验的样本空间为 $S=\{e_1,e_2,\cdots,e_n\}$，由于每个基本事件的发生是等可能的，有

$$
P(\{e_1\})=P(\{e_2\})=\cdots=P(\{e_n\})
$$

又由于基本事件是两两不相容的，因此

$$
1=P(S)=P(\{e_1\}\cup\{e_2\}\cup\cdots\cup \{e_n\})=P(\{e_1\})+P(\{e_2\})+\cdots+P(\{e_n\})=nP(\{e_i\})\\
P(\{e_i\})=\frac{1}{n},\ i=1,2,\cdots,n
$$

若事件 $A$ 包含 $k$ 个基本事件，即 $A=\{e_{i_1}\}\cup \{e_{i_2}\}\cup \cdots \cup\{e_{i_k}\}$，其中 $i_1,i_2,\cdots,i_k$ 是 $k$ 个互不相同的数，则有

$$
P(A)=\sum_{j=1}^k P(\{e_{i_j}\})=\frac{k}{n}
$$

<br/>

@假设某个班上有 $n$ 个人，其中 $n\le365$，每个人的生日在一年365天（不考虑闰年）的任一天是等可能的，那么他们的生日各不相同的概率为

$$
\frac{365\times 364\times \cdots\times (365-n+1)}{365^n}
$$

# 条件概率

先观察一个例子：

@将一枚均匀的硬币抛掷两次，设事件 $A$ 为“至少有一次为正面”，事件 $B$ 为“两次掷出同一面”，求已知事件 $A$ 已经发生的条件下事件 $B$ 发生的概率。

这里样本空间 $S=\{HH,HT,TH,TT\},A=\{HH,HT,TH\},B=\{HH,TT\}$，其中 $H,T$ 分别表示正、反面。已知事件 $A$ 发生，那么试验所有可能结果的集合就是 $A$， $A$ 中共有3个元素，其中只有 $HH\in B$，因此所求概率为 $1/3$。

这里我们发现 $P(AB)=1/4,P(A)=3/4,P(AB)/P(A)=1/3$ 正好等于所求概率，由此我们给出条件概率的定义。

设 $A,B$ 是两个事件，且 $P(A)>0$，定义

$$
P(B|A)=\frac{P(AB)}{P(A)}
$$

为事件 $A$ 发生的条件下事件 $B$ 发生的**条件概率**。

条件概率符合概率定义中的三个条件（容易验证），因此概率的性质也都适用于条件概率。

由条件概率的定义，可以得到乘法定理：

**乘法定理** 设 $P(A)>0$，则有
$$
P(AB)=P(B|A)P(A)
$$
将此公式推广到多个事件的交集，则有
$$
P(A_1A_2,\cdots A_n)=P(A_n|A_1A_2\cdots A_{n-1})P(A_{n-1}|A_1A_2\cdots A_{n-1})\cdots P(A_2|A_1)P(A_1)
$$
其中对于 $n\ge2,P(A_1A_2\cdots A_{n-1})>0$。

@假定一个盒子里有7个黑球，5个白球，我们不放回地从中摸出两个球，假设盒子里每个球都是等可能地被摸出，求摸出的两个球都是黑球的概率。

记 $A,B$ 分别为事件“第一个球为黑球”和“第二个球是黑球”，那么
$$
P(AB)=P(A)P(B|A)=\frac{7}{12}\frac{6}{11}=\frac{7}{22}
$$

# 全概率公式和贝叶斯公式

设 $S$ 为试验 $E$ 的样本空间， $B_1,B_2,\cdots,B_n$ 为 $E$ 的一组事件，若

1. $B_iB_j=\varnothing,i,j=1,2,\cdots,n且i\neq j$ 
2. $B_1B_2\cdots B_n=S$ 

则称 $B_1,B_2,\cdots,B_n$ 是 $S$ 的一个**划分**。

@试验“掷骰子”中，样本空间为 $S=\{1,2,3,4,5,6\}$，一组事件 $B_1=\{1,2,3\},B_2=\{4,5\},B_3=\{6\}$ 是 $S$ 的一个划分。

**全概率公式** 设试验 $E$ 的样本空间为 $S$， $A$ 为 $E$ 的事件， $B_1,B_2,\cdots,B_n$ 是 $S$ 的一个划分，且 $P(B_i)>0\ (i=1,2,\cdots,n)$，则
$$
P(A)=P(A|B_1)P(B_1)+P(A|B_2)P(B_2)+\cdots+P(A|B_n)P(B_n)
$$

**贝叶斯公式** 设试验 $E$ 的样本空间为 $S$， $A$ 为 $E$ 的事件， $B_1,B_2,\cdots,B_n$ 是 $S$ 的一个划分，且 $P(A)>0,P(B_i)>0\ (i=1,2,\cdots,n)$，则
$$
P(B_i|A)=\frac{P(A|B_i)P(B_i)}{\sum_{j=1}^nP(A|B_j)P(B_j)},\quad i=1,2,\cdots,n
$$

@对以往数据的分析表明，当机器正常工作时，产品的合格率为98%，而当机器发生某种故障时，产品的合格率为55%。每天早上机器开动时，机器正常工作的概率为95%。求已知某日早上第一件产品是合格品时，机器正常工作的概率。

记 $A,B$ 分别为事件“第一件产品合格”和“机器正常工作”，由题意有 $P(A|B)=0.98,P(A|\overline{B})=0.55,P(B)=0.95$，由贝叶斯公式

$$
P(B|A)=\frac{P(A|B)P(B)}{P(A|B)P(B)+P(A|\overline{B})P(\overline{B})}=\frac{0.98\times 0.95}{0.98\times0.95+0.55\times0.05}=0.97
$$

> 这里 $P(B)=0.95$ 是根据以往数据得到的，称为**先验概率**； $P(B|A)=0.97$ 是在得到新信息之后得到的，称为**后验概率**。

# 独立性

如果 $P(B|A)=P(B)$，我们称为事件 $A$ 的发生对于事件 $B$ 的发生没有影响，由此给出独立的定义。

设 $A,B$ 是两事件，如果满足等式
$$
P(AB)=P(A)P(B)
$$
则称事件 $A,B$ **独立**。

**定理** 若事件 $A,B$ 独立，且 $P(A)>0$，则 $P(B|A)=P(B)$。反之亦然。

**定理** 若事件 $A,B$ 独立，则下列各对事件也独立
$$
A与\overline{B},\quad\overline{A}与B,\quad \overline{A}与\overline{B}
$$

一般地，对于事件 $A_1,A_2,\cdots,A_n$，如果其中任意个任意事件的交集的概率都等于各事件概率之积，则称 $A_1,A_2,\cdots,A_n$ **独立**。由此可以得到以下推论：

* 若事件 $A_1,A_2,\cdots,A_n$ 独立，则其中任意个任意事件也是独立的
* 若事件 $A_1,A_2,\cdots,A_n$ 独立，则将其中任意个任意事件换成它们的对立事件后，得到的n个事件仍然独立

@甲乙两人进行乒乓球赛，每局甲胜的概率均为 $p,\ 1/2<p<1$，且各局胜负相互独立。问三局两胜和五局三胜两个赛制中，哪个对于甲而言更加有利？

若采用BO3，则甲获胜的可能情况是：甲甲，甲乙甲，乙甲甲，概率为 $p_3=p^2+2p^2(1-p)$ 

若采用BO5，则甲获胜的可能情况是： $n\ (3\le n\le 5)$ 局中，甲获胜最后1局和前 $n-1$ 局中的2局，概率为 $p_5=p^3+{\rm C}_3^2p^3(1-p)+{\rm C}_4^2p^3(1-p)^2$ 

$$
p_5-p_3=p^2(6p^3-15p^2+12p-3)=3p^2(p-1)^2(2p-1)>0
$$

因此采用BO5对甲更有利。
