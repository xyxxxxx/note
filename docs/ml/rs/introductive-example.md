> 参见tensorflow的[tfrs教程](https://www.tensorflow.org/recommenders/examples/basic_retrieval)

推荐系统模型通常包含2个阶段：

1. 召回阶段负责从所有（ $10^6\sim10^8$ 量级）的候选物品中初步选择几百个候选物品。这一阶段的主要目标是<u>高效地</u>过滤掉用户不感兴趣的候选物品。
2. 排序阶段负责进一步精调召回阶段的输出，将范围缩小到候选物品的一个短列表中。

## 召回

召回模型通常包括2个子模型：

1. 查询模型，使用查询特征计算查询表示
2. 候选模型，使用候选特征计算候选表示

这两个模型的输出做乘积以得到查询-候选关系(affinity)得分，高得分表示查询与候选物品之间有好的匹配。

数据集选用`Movielens-1k`