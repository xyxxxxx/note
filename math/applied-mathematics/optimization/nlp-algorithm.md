# 算法

前面讨论了最优性条件，理论上讲可以用这些条件求非线性规划的最优解，但在实际中往往并不可行，因为一般需要求解非线性方程组，这本来就是一个困难问题。因此求解非线性规划一般采用数值计算方法。

最常见的解非线性规划的算法是**迭代下降算法**。所谓**迭代**，就是从$$\pmb x^{(k)}$$出发，按照某种规则$$A$$求出后继点$$\pmb x^{(k+1)}$$，用$$k+1$$替代$$k$$，重复以上过程便产生点列$$\{\pmb x^{(k)}\}$$；所谓**下降**，就是每次迭代后函数值都有所减小。在一定条件下，迭代下降算法产生的点列收敛于原问题的解。

**算法映射** **算法**$$A$$是定义在空间$$X$$上的点到集映射，即对任意点$$\pmb x\in X$$，返回一个子集$$A(\pmb x)\sub X$$。

**解集合** 满足最终要求的点的集合称为**解集合**，当迭代点属于这个集合时就停止迭代。

**下降函数** 设解集合$$\Omega\sub X$$，算法$$A$$，$$\alpha(\pmb x)$$是定义在$$X$$上的连续实函数，若满足以下条件：

1. 当$$\pmb x\notin \Omega$$且$$\pmb y\in A(\pmb x)$$时，$$\alpha(\pmb y)<\alpha(\pmb x)$$
2. 当$$\pmb x\in \Omega$$且$$\pmb y\in A(\pmb x)$$时，$$\alpha(\pmb y)\le\alpha(\pmb x)$$

则称$$\alpha$$是关于解集合$$\Omega$$和算法$$A$$的**下降函数**。

一般地，当我们求解非线性规划问题时，通常取$$||\nabla f(\pmb x)||$$或$$f(\pmb x)$$作为下降函数。

**闭映射** 设$$X,Y$$分别是$$\mathbb{R}^p,\mathbb{R}^q$$中的非空闭集，$$A:X\to Y$$为点到集映射，如果
$$
\pmb x^{(k)}\in X,\ \pmb x^{(k)}\to \pmb x\\
\Rightarrow A(\pmb x^{(k)})\ni \pmb y^{(k)}\to \pmb y\in A(\pmb x)\\
$$
则称映射$$A$$在$$\pmb x\in X$$处是**闭的**。如果映射$$A$$在集合$$Z\sub X$$上的每一点是闭的，则称$$A$$在$$Z$$上是**闭的**。



## 算法收敛问题

### 收敛定理

**收敛** 设解集合$$\Omega$$，算法$$A:X\to X$$，若以任一初点$$\pmb x^{(1)}\in X$$开始，算法产生的序列的任一收敛子序列的极限属于$$\Omega$$，则称算法映射$$A$$在$$X$$上**收敛**。

**收敛定理** 设解集合$$\Omega$$，$$A$$是$$X$$上的算法，给定初点$$\pmb x^{(1)}\in X$$，进行如下迭代：

+ 若$$\pmb x^{(k)}\in \Omega$$，则停止迭代；否则令$$\pmb x^{(k+1)}\in A(\pmb x^{(k)})$$，将$$k+1$$替换为$$k$$，重复本操作

由此产生序列$$\{\pmb x^{(k)}\}$$，又设

1. 序列$$\{\pmb x^{(k)}\}$$包含于$$X$$的紧子集中
2. 存在一个连续函数$$\alpha$$，它是关于$$\Omega$$和$$A$$的下降函数
3. 映射$$A$$在$$\Omega$$的补集上是闭的

则序列$$\{\pmb x^{(k)}\}$$的任一收敛子序列的极限属于$$\Omega$$。



### 实用收敛准则

迭代下降算法中，当$$\pmb x^{(k)}\in \Omega$$才停止迭代，然而在实践过程中的很多情况下迭代永远不会停止。因此为了解决实际问题，需要规定一些实用的终止迭代的准则，称为**收敛准则**或**停步准则**。

常用的收敛准则有以下几种：

1. 当自变量的改变量充分小时，停止计算
   $$
   ||\pmb x^{(k+1)}-\pmb x^{(k)} ||<\varepsilon\\
   或\ \frac{||\pmb x^{(k+1)}-\pmb x^{(k)} ||}{||\pmb x^{(k)}||}<\varepsilon
   $$

2. 当函数值的下降量充分小时，停止计算
   $$
   |f(\pmb x^{(k+1)})-f(\pmb x^{(k)})|<\varepsilon\\
   或\ \frac{|f(\pmb x^{(k+1)})-f(\pmb x^{(k)})|}{|f(\pmb x^{(k)})|}<\varepsilon
   $$

3. 在无约束最优化中，当梯度充分接近零时，停止计算
   $$
   ||\nabla f(\pmb x^{(k)}) ||<\varepsilon
   $$
   

### 收敛速率

**收敛速率** 设序列$$\{\pmb \gamma^{(k)}\}$$收敛于$$\pmb \gamma^*$$，定义满足
$$
0\le \lim_{k\to \infty}\frac{||\pmb \gamma^{(k+1)}-\pmb \gamma^* ||}{||\pmb \gamma^{(k)}-\pmb \gamma^* ||^p}=\beta <\infty
$$
的非负数$$p$$的上确界为序列$$\{\pmb \gamma^{(k)}\}$$的**收敛级**，称序列是$$p$$级收敛的。若$$p=1,\beta<1$$则称序列是**以收敛比$$\beta$$线性收敛的**。



@考虑序列
$$
\{a^k\},\quad 0<a<1
$$
由于$$a^k\to 0$$以及
$$
\lim_{k\to \infty}\frac{a^{k+1}}{a^k}=a<1
$$
因此，序列$$\{a^k\}$$以收敛比$$a$$线性收敛于零。



@考虑序列
$$
\{a^{2^k}\},\quad 0<a<1
$$
由于$$a^{2^k}\to 0$$以及
$$
\lim_{k\to \infty}\frac{a^{2^{k+1}}}{(a^{2^k})^2}=1
$$
因此，序列$$\{a^{2^k}\}$$2级收敛。





# 一维搜索

求目标函数在直线上的极小点称为**一维搜索**，或称为**线搜索**。

设目标函数为$$f(\pmb x)$$，过点$$\pmb x^{(k)}$$沿方向$$\pmb d^{(k)}$$的直线可用点集表示，记作
$$
L=\{\pmb x|\pmb x=\pmb x^{(k)}+\lambda \pmb d^{(k)},-\infty<\lambda<\infty \}
$$
求$$f(\pmb x)$$在直线$$L$$上的极小点转化为求一元函数
$$
\varphi(\lambda)=f(\pmb x^{(k)}+\lambda \pmb d^{(k)})
$$
的极小点。

一维搜索的方法归纳起来，大体可分为两类：

+ **试探法** 这类方法需要按某种方式寻找试探点，通过一系列试探点来确定极小点
+ **函数逼近法/插值法** 这类方法用某种较简单的曲线逼近本来的函数曲线，通过求逼近函数的极小点来估计目标函数的极小点

这两类方法一般只能求得极小点的近似值。



## 试探法





# 使用导数的最优化方法