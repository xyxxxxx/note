# 正则表达式

**正则表达式（regular expression）**是一种正则语言的表示方法，这种方法使用字母表$$\Sigma$$上的所有符号、圆括号$$()$$、并集操作符$$+$$、连接操作符$$\cdot$$和星闭包操作符$$*$$的组合。@例如语言$$\{a\}$$用正则表达式$$a$$表示，语言$$\{a,b,c\}$$用正则表达式$$a+b+c$$表示，语言$$\{a，bc\}^*$$用正则表达式$$(a+b\cdot c)^*$$表示



**定义** 设$$\Sigma$$是给定的字母表，那么

1. $$\varnothing$$，$$\lambda$$和$$a\in \Sigma$$都是正则表达式，称为**基本正则表达式（primitive regular expression）**
2. 如果$$r_1$$和$$r_2$$是正则表达式，那么$$r_1+r_2$$，$$r_1\cdot r_2$$，$$r_1^*$$，$$(r_1)$$也是正则表达式
3. 当且仅当把规则2有限次应用于基本正则表达式得到的符号串才是正则表达式



**定义** 使用正则表达式$$r$$表示的语言$$L(r)$$，由以下规则定义：

1. 正则表达式$$\varnothing$$表示语言空集

2. 正则表达式$$\lambda$$表示语言$$\{\lambda\}$$

3. 正则表达式$$a$$表示语言$$\{a\}$$，其中$$a\in \Sigma$$

   如果$$r_1$$和$$r_2$$是正则表达式，那么

4. $$L(r_1+r_2)=L(r_1)\cup L(r_2)$$

5. $$L(r_1\cdot r_2)=L(r_1) L(r_2)$$

6. $$L((r_1))=L(r_1)$$

7. $$L(r_1^*)=L^*(r_1)$$



@正则表达式$$→$$集合表示
$$
\begin{align}
L(a^*\cdot (a+b)) & =L(a^*)L(a+b)\\
& =L^*(a)(L(a)\cup L(b))\\
& =\{\lambda,a,aa,aaa,\cdots\}\{a,b\}\\
& =\{a,aa,aaa,\cdots,b,ab,aab,\cdots\}
\end{align}
$$

$$
\begin{align}
L((aa)^*(bb)^*b) & =L^*(aa)L^*(bb)L(b)\\
& =\{\lambda, aa,aaaa,\cdots\}\{\lambda,bb,bbbb,\cdots\}\{b\}\\
& =\{a^{2n}b^{2m+1}:n\ge0,m\ge0 \}
\end{align}
$$

@集合表示$$→$$正则表达式
$$
\begin{align}
给定\Sigma=\{0,1\}, & \\
\{w\in\Sigma^*:w至少有一对连续的0 \} & =L^*(0+1)L(00)L^*(0+1)\\
& =L((0+1)^*00(0+1)^*)\\
\{w\in\Sigma^*:w没有连续的0 \} & ==L((1+01)^*(0+\lambda))\\
\end{align}
$$




# 正则表达式与正则语言

**定理** 设$$r$$是正则表达式，那么一定存在某个DFA或NFA接受$$L(r)$$，即$$L(r)$$是正则语言。

> 证明略



**定理** 设$$L$$是正则语言，那么一定存在正则表达式$$r$$，使得$$L=L(r)$$。

> 证明略





# 正则文法

**定义** 如果所有的产生式都满足如下形式，文法$$G=(V,T,S,P)$$称为**右线性（right-linear）**文法
$$
A\to xB\\
A\to x
$$
其中$$A,B\in V，x\in T^*$$；类似地，产生式满足如下形式的文法称为**左线性（left-linear）**文法
$$
A\to Bx\\
A\to x
$$
左线性文法和右线性文法统称**正则文法（regular grammar）**。



@例如右线性文法$$G_1=(\{S\},\{a,b\},S,P_1)$$，产生式
$$
S\to abS|a
$$
可以看出$$L(G_1)=L((ab)^*a)$$



文法$$G=(\{S,A,B\},\{a,b\},S,P)$$，产生式
$$
S\to A\\
A\to aB|\lambda\\
B\to Ab
$$
尽管每个产生式都是右线性或者左线性的，但是文法既不是右线性也不是左线性，因此不是正则文法，称为**线性文法（linear grammar）**。



**定理** 如果$$L$$是正则语言，当且仅当存在正则文法$$G$$，使得$$L=L(G)$$。

> 证明略。



@正则文法$$\to$$NFA
$$
V_0\to aV_1\\
V_1\to abV_0|b
$$
![Screenshot from 2020-09-11 12-33-40.png](https://i.loli.net/2020/09/11/byzL7XPhnErcFo2.png)

@集合表示$$\to$$正则文法
$$
L(aab^*a)\\
q_0\to aq_1,q_1\to aq_2,q_2\to bq_2,q_2\to aq_f,q_f\to \lambda
$$




# 正则语言的封闭性

**定理**  如果$$L_1$$和$$L_2$$是正则语言，那么$$L_1\cup L_2$$，$$L_1\cap L_2$$，$$L_1L_2$$，$$L_1-L_2$$，$$\overline{L}_1$$，$$L^R$$和$$L_1^*$$也都是正则的。即正则语言族在并、交、连接、差、补、逆和星闭包上都是封闭的。

> 证明略。



假设$$\Sigma$$和$$\Gamma$$是字母表，那么函数
$$
h:\Sigma\to \Gamma^*
$$
称为**同态（homomorphism）**。换句话说，同态就是把一个符号用一个符号串替代。同态的定义域可以扩展为符号串，即
$$
h(w)=h(a_1)h(a_2)\cdots h(a_n)
$$
如果$$L$$是定义在$$\Sigma$$上的语言，那么它的**同态映像（homomorphic image）**就定义为
$$
h(L)=\{h(w):w\in L\}
$$


**定理** 设$$h$$是同态，如果$$L$$是正则的，那么它的同态映像$$h(L)$$也是正则的。即正则语言族在任意同台运算上都是封闭的。

> 证明略。



**定义** 设$$L_1$$和$$L_2$$是定义在同一个字母表上的语言，那么$$L_1$$和$$L_2$$的**右商（right quotient）**定义为
$$
L_1/L_2=\{x:xy\in L_1，y\in L_2\}
$$
@例如
$$
L_1=\{a^nb^m:n\ge 1,m\ge 0\}\cup\{ba\}\\
L_2=\{b^m:m\ge 1\}
$$
那么
$$
L_1/L_2=\{a^nb^m:n\ge 1,m\ge 0\}
$$


**定理** 如果$$L_1$$和$$L_2$$是正则语言，那么$$L_1/L_2$$也是正则的。即正则语言族在右商运算上是封闭的。

> 证明略。

> 此外，正则语言族对于左商、对称差、nor、cor等许多运算也都是封闭的。





# 正则语言的基本问题

给定语言$$L$$和符号串$$w$$，我们能否判断$$w$$是不是$$L$$的元素？这个一个**成员资格（membership）**问题，解决这一问题的方法称为成员资格算法。遗憾的是，对于一般的语言，我们找不到有效的成员资格算法；然而对于正则语言，**标准表示法（standard representation）**——有穷自动机、正则表达式或正则文法——给出了算法。

**定理** 标准表示法存在算法判断符号串$$w$$是否属于正则语言$$L$$。

**定理** 标准表示法存在算法判断正则语言$$L$$是空的、有穷的还是无穷的。

**定理** 标准表示法存在算法判断正则语言$$L_1=L_2$$是否成立。





# 识别非正则语言

@语言$$L=\{a^nb^n:n\ge 0\}$$不是正则语言，因为需要无穷个状态表示$$a$$的个数。



**泵引理（pumping lemma）** 设$$L$$是无穷的正则语言，那么​<u>存在正整数$$m$$</u>，对任意$$w\in L, |w|\ge m$$，$$w$$都存在一种分解
$$
w=xyz
$$
其中
$$
|xy|\le m\\
|y|\ge 1
$$
并且对于$$i=0,1,2,\cdots$$也满足
$$
w_i=xy^iz\in L
$$

> 证明：
>
> 如果$$L$$是正则语言，那么存在一个识别它的DFA，假设这个DFA的状态分别为$$q_0,q_1,q_2,\cdots,q_n$$。由于$$L$$是无穷的，因此$$L$$中的符号串可以趋于无穷长度（反证）。取$$L$$中的任意符号串$$w$$，且满足$$|w|\ge m=n+1$$。考虑自动机处理$$w$$时经过的状态集合，如
> $$
> q_0,q_1,\cdots,q_f
> $$
> 这个序列共有$$|w|+1$$项，所以至少有一个状态会被重复，并且这个重复的发生不晚于第n+1次状态转移。因此这个序列应该形如
> $$
> q_0,q_1,\cdots,q_r,\cdots,q_r,\cdots,q_f
> $$
> 因此存在$$w$$的子串$$x,y,z$$，满足
> $$
> \delta^*(q_0,x)=q_r\\
> \delta^*(q_r,y)=q_r\\
> \delta^*(q_r,z)=q_f\\
> $$
> 其中$$|y|\ge 1$$，由此我们可以得到
> $$
> \delta^*(q_0,xz)=q_f\\
> \delta^*(q_0,xy^2z)=q_f\\
> \cdots
> $$



泵引理用于证明某种语言不是正则的（但不能用于证明某种语言是正则的），@例如再次证明语言$$L=\{a^nb^n:n\ge 0\}$$不是正则语言：

假设$$L$$是正则的，那么泵引理成立。取$$w=a^mb^m$$，由于$$|xy|\le m$$，设$$y=a^i,i>0$$，那么
$$
xz=a^{m-i}b^m\notin L
$$
与泵引理矛盾，因此假设不成立，$$L$$不是正则的。

> 证明方法简单总结为：从$$L$$中找出一个长度不小于$$m$$的符号串$$w$$；任意地分解为$$xyz$$，其中$$|xy|\le m,|y|\ge 1$$，都发现存在$$xy^iz\notin L$$



此外还可以使用正则语言的封闭性来反证。